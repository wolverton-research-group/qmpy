(function(a){a.extend(a.support,{iecors:!!window.XDomainRequest});a.support.iecors?a.ajaxTransport(function(a){return{send:function(c,d){var f=new window.XDomainRequest;f.onload=function(){d(200,"OK",{text:f.responseText},{"Content-Type":f.contentType})};a.xhrFields&&(f.onerror=a.xhrFields.error,f.ontimeout=a.xhrFields.timeout);f.open(a.type,a.url);f.send(a.hasContent&&a.data||null)},abort:function(){xdr.abort()}}}):(a.ajaxSetup({accepts:{binary:"text/plain; charset=x-user-defined"},responseFields:{binary:"response"}}),
a.ajaxTransport("binary",function(a){var c;return{send:function(d,f){var b=a.xhr();b.open(a.type,a.url,!1);b.hasOwnProperty("responseType")?b.responseType="arraybuffer":b.overrideMimeType&&b.overrideMimeType("text/plain; charset=x-user-defined");!a.crossDomain&&!d["X-Requested-With"]&&(d["X-Requested-With"]="XMLHttpRequest");try{for(var e in d)b.setRequestHeader(e,d[e])}catch(n){}b.send(a.hasContent&&a.data||null);c=function(){var e=b.status,n="",d=b.getAllResponseHeaders(),l={};try{if(c&&4===b.readyState){c=
void 0;try{l.text="string"===typeof b.responseText?b.responseText:null}catch(p){}try{l.binary=b.response}catch(m){}try{n=b.statusText}catch(q){n=""}!e&&a.isLocal&&!a.crossDomain?e=l.text?200:404:1223===e&&(e=204);f(e,n,l,d)}}catch(r){alert(r),f(-1,r)}};c()},abort:function(){}}}))})(jQuery);
(function(a,g,c,d){function f(b,e){function c(b){a(f).each(function(){var c=a(this);this!==b.target&&!c.has(b.target).length&&c.triggerHandler(e,[b.target,b])})}e=e||b+d;var f=a(),k=b+"."+e+"-special-event";a.event.special[e]={setup:function(){f=f.add(this);1===f.length&&a(g).bind(k,c)},teardown:function(){f=f.not(this);0===f.length&&a(g).unbind(k)},add:function(b){var e=b.handler;b.handler=function(b,a){b.target=a;e.apply(this,arguments)}}}}a.map(c.split(" "),function(b){f(b)});f("focusin","focus"+
d);f("focusout","blur"+d)})(jQuery,document,"click mousemove mouseup touchmove touchend","outjsmol");"undefined"==typeof jQuery&&alert("Note -- JSmoljQuery is required for JSmol, but it's not defined.");
Jmol=function(a){return{_jmolInfo:{userAgent:navigator.userAgent,version:version="Jmol-JSO 13.0"},_allowedJmolSize:[25,2048,300],_applets:{},_asynchronous:!0,_ajaxQueue:[],db:{_databasePrefixes:"$=:",_fileLoadScript:";if (_loadScript = '' && defaultLoadScript == '' && _filetype == 'Pdb') { select protein or nucleic;cartoons Only;color structure; select * };",_nciLoadScript:";n = ({molecule=1}.length < {molecule=2}.length ? 2 : 1); select molecule=n;display selected;center selected;",_pubChemLoadScript:"",
_DirectDatabaseCalls:{"cactus.nci.nih.gov":"%URL","www.rcsb.org":"%URL","pubchem.ncbi.nlm.nih.gov":"%URL",$:"http://cactus.nci.nih.gov/chemical/structure/%FILE/file?format=sdf&get3d=True",$$:"http://cactus.nci.nih.gov/chemical/structure/%FILE/file?format=sdf","=":"http://www.rcsb.org/pdb/files/%FILE.pdb","==":"http://www.rcsb.org/pdb/files/ligand/%FILE.cif",":":"http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/%FILE/SDF?record_type=3d"},_restQueryUrl:"http://www.rcsb.org/pdb/rest/search",_restQueryXml:"<orgPdbQuery><queryType>org.pdb.query.simple.AdvancedKeywordQuery</queryType><description>Text Search</description><keywords>QUERY</keywords></orgPdbQuery>",
_restReportUrl:"http://www.pdb.org/pdb/rest/customReport?pdbids=IDLIST&customReportColumns=structureId,structureTitle"},_debugAlert:!1,_document:a,_execLog:"",_execStack:[],_isMsie:0<=navigator.userAgent.toLowerCase().indexOf("msie"),_isXHTML:!1,_lastAppletID:null,_mousePageX:null,_serverUrl:"http://chemapps.stolaf.edu/jmol/jsmol.jsmol.php",_touching:!1,_XhtmlElement:null,_XhtmlAppendChild:!1}}(document);
(function(a,g){a.$=function(b,e){return g(e?"#"+b._id+"_"+e:b)};a.$after=function(b,e){g(b).after(e)};a.$ajax=function(b){return g.ajax(b)};a.$attr=function(b,e,a){return g("#"+b).attr(e,a)};a.$bind=function(b,e,a){return a?g(b).bind(e,a):g(b).unbind(e)};a.$appStyle=function(b,e,c){return a.$(b,e).css(c)};a.$appEvent=function(b,e,c,d){a.$(b,e).off(c);if(d)a.$(b,e).on(c,d)};a.$focus=function(b){return g("#"+b).focus()};a.$get=function(b,e){return g(b).get(e)};a.$html=function(b,e){return g("#"+b).html(e)};
a.$offset=function(b){return g("#"+b).offset()};a.$documentOff=function(b,e){g(document).off(b,"#"+e)};a.$documentOn=function(b,e,a){g(document).on(b,"#"+e,a)};a.$windowOn=function(b,e){return g(window).on(b,e)};a.$prop=function(b,e){return g("#"+b).prop(e)};a.$resize=function(b){return g(window).resize(b)};a.$submit=function(b){return g("#"+b).submit()};a.$val=function(b,e){return 1==arguments.length?g("#"+b).val():g("#"+b).val(e)};a._clearVars=function(){delete jQuery;delete g;delete a;java&&(delete J,
delete JZ,delete java,delete Clazz,delete JavaObject,delete bhtest,delete xxxbhparams,delete xxxShowParams,delete c$,delete d$,delete w$,delete $_A,delete $_AB,delete $_AC,delete $_AD,delete $_AF,delete $_AI,delete $_AL,delete $_AS,delete $_Ab,delete $_B,delete $_C,delete $_D,delete $_E,delete $_F,delete $_G,delete $_H,delete $_I,delete $_J,delete $_K,delete $_L,delete $_M,delete $_N,delete $_O,delete $_P,delete $_Q,delete $_R,delete $_S,delete $_T,delete $_U,delete $_V,delete $_W,delete $_X,delete $_Y,
delete $_Z,delete $_k,delete $_s,delete $t$)};var c=document,d=window,f={};f.ua=navigator.userAgent.toLowerCase();f.os=function(){for(var b=["linux","unix","mac","win"],e=b.length;e--;)if(-1!=f.ua.indexOf(b[e]))return b[e];return"unknown"};f.browser=function(){for(var b=f.ua,e="konqueror webkit omniweb opera webtv icab msie mozilla".split(" "),a=0;a<e.length;a++)if(0<=b.indexOf(e[a]))return e[a];return"unknown"};f.browserName=f.browser();f.browserVersion=parseFloat(f.ua.substring(f.ua.indexOf(f.browserName)+
f.browserName.length+1));f.supportsXhr2=function(){return g.support.cors||g.support.iecors};f.allowDestroy="msie"!=f.browserName;f.allowHTML5="msie"!=f.browserName||0>navigator.appVersion.indexOf("MSIE 8");f.getDefaultLanguage=function(){return navigator.language||navigator.userLanguage||"en-US"};f._webGLtest=0;f.supportsWebGL=function(){if(!a.featureDetection._webGLtest){var b;a.featureDetection._webGLtest=d.WebGLRenderingContext&&((b=c.createElement("canvas")).getContext("webgl")||b.getContext("experimental-webgl"))?
1:-1}return 0<a.featureDetection._webGLtest};f.supportsLocalization=function(){for(var b=c.getElementsByTagName("meta"),e=b.length;0<=--e;)if(0<=b[e].outerHTML.toLowerCase().indexOf("utf-8"))return!0;return!1};f.supportsJava=function(){if(!a.featureDetection._javaEnabled){if(a._isMsie)return!0;a.featureDetection._javaEnabled=navigator.javaEnabled()?1:-1}return 0<a.featureDetection._javaEnabled};f.compliantBrowser=function(){var b=!!c.getElementById,e=f.os();if("opera"==f.browserName&&7.54>=f.browserVersion&&
"mac"==e||"webkit"==f.browserName&&125.12>f.browserVersion||"msie"==f.browserName&&"mac"==e||"konqueror"==f.browserName&&3.3>=f.browserVersion)b=!1;return b};f.isFullyCompliant=function(){return f.compliantBrowser()&&f.supportsJava()};f.useIEObject="win"==f.os()&&"msie"==f.browserName&&5.5<=f.browserVersion;f.useHtml4Object="mozilla"==f.browserName&&5<=f.browserVersion||"opera"==f.browserName&&8<=f.browserVersion||"webkit"==f.browserName&&412.2<=f.browserVersion;f.hasFileReader=d.File&&d.FileReader;
a.featureDetection=f;a._ajax=function(b){if(!b.async)return a.$ajax(b).responseText;a._ajaxQueue.push(b);1==a._ajaxQueue.length&&a._ajaxDone()};a._ajaxDone=function(){var b=a._ajaxQueue.shift();b&&a.$ajax(b)};a._grabberOptions=[["$","NCI(small molecules)"],[":","PubChem(small molecules)"],["=","RCSB(macromolecules)"]];a._getGrabberOptions=function(b,e){if(0==a._grabberOptions.length)return"";var c='<input type="text" id="ID_query" onkeypress="13==event.which&&Jmol._applets[\'ID\']._search()" size="32" value="" />',
d='<button id="ID_submit" onclick="Jmol._applets[\'ID\']._search()">Search</button></nobr>';1==a._grabberOptions.length?(c="<nobr>"+c+'<span style="display:none">',d="</span>"+d):c+="<br /><nobr>";for(var c=c+'<select id="ID_select">',f=0;f<a._grabberOptions.length;f++)var g=a._grabberOptions[f],c=c+('<option value="'+g[0]+'" '+(0==f?"selected":"")+">"+g[1]+"</option>");c=(c+"</select>"+d).replace(/ID/g,b._id)+(e?e:"");return"<br />"+c};a._getScriptForDatabase=function(b){return"$"==b?a.db._nciLoadScript:
":"==b?a.db._pubChemLoadScript:a.db._fileLoadScript};a._setInfo=function(b,e,a){var c=[],d="";if(0==a.indexOf("ERROR"))d=a;else switch(e){case "=":e=a.split("<dimStructure.structureId>");c=["<table>"];for(a=1;a<e.length;a++)c.push('<tr><td valign=top><a href="javascript:Jmol.search('+b._id+",'="+e[a].substring(0,4)+"')\">"+e[a].substring(0,4)+"</a></td>"),c.push("<td>"+e[a].split("Title>")[1].split("</")[0]+"</td></tr>");c.push("</table>");d=e.length-1+" matches";break;case "$":case ":":break;default:return}b._infoHeader=
d;b._info=c.join("");b._showInfo(!0)};a._loadSuccess=function(b,e){e&&(a._ajaxDone(),e(b))};a._loadError=function(b){a._ajaxDone();a.say("Error connecting to server.");null!=b&&b()};a._isDatabaseCall=function(b){return 0<=a.db._databasePrefixes.indexOf(b.substring(0,1))};a._getDirectDatabaseCall=function(b,e){if(e&&!a.featureDetection.supportsXhr2())return b;var c=2,d,f=a.db._DirectDatabaseCalls[b.substring(0,c)];f||(f=a.db._DirectDatabaseCalls[d=b.substring(0,--c)]);f&&":"==d&&(d=b.toLowerCase(),
isNaN(parseInt(b.substring(1)))?0==d.indexOf(":smiles:")?(f+="?POST?smiles="+b.substring(8),b=":smiles"):0==d.indexOf(":cid:")?b=":cid/"+b.substring(5):(0==d.indexOf(":name:")?b=b.substring(5):0==d.indexOf(":cas:")&&(b=b.substring(4)),b=":name/"+encodeURIComponent(b.substring(1))):b=":cid/"+b.substring(1));return b=f?f.replace(/\%FILE/,b.substring(c)):b};a._getRawDataFromServer=function(b,e,c,d,f,g){b="?call=getRawDataFromDatabase&database="+b+"&query="+encodeURIComponent(e)+(f?"&encoding=base64":
"")+(g?"":"&script="+encodeURIComponent(a._getScriptForDatabase(b)));return a._contactServer(b,c,d)};a._getInfoFromDatabase=function(b,e,c){if("===="==e){var d=a.db._restQueryXml.replace(/QUERY/,c),d={dataType:"text",type:"POST",contentType:"application/x-www-form-urlencoded",url:a.db._restQueryUrl,data:encodeURIComponent(d)+"&req=browser",success:function(d){a._ajaxDone();a._extractInfoFromRCSB(b,e,c,d)},error:function(){a._loadError(null)},async:a._asynchronous};return a._ajax(d)}c="?call=getInfoFromDatabase&database="+
e+"&query="+encodeURIComponent(c);return a._contactServer(c,function(c){a._setInfo(b,e,c)})};a._extractInfoFromRCSB=function(b,e,c,d){var f=d.length/5;if(0!=f&&4==c.length&&1!=f){c=c.toUpperCase();var g=d.indexOf(c);0<g&&0<="123456789".indexOf(c.substring(0,1))&&(d=c+","+d.substring(0,g)+d.substring(g+5));50<f&&(d=d.substring(0,250));d=d.replace(/\n/g,",");d=a._restReportUrl.replace(/IDLIST/,d);a._loadFileData(b,d,function(c){a._setInfo(b,e,c)})}};a._loadFileData=function(b,e,c,d){if(a._isDatabaseCall(e)&&
(a._setQueryTerm(b,e),e=a._getDirectDatabaseCall(e,!0),a._isDatabaseCall(e))){e=a._getDirectDatabaseCall(e,!1);a._getRawDataFromServer("_",e,c,d);return}b={dataType:"text",url:e,async:a._asynchronous,success:function(b){a._loadSuccess(b,c)},error:function(){a._loadError(d)}};var f=e.indexOf("?POST?");0<f&&(b.url=e.substring(0,f),b.data=e.substring(f+6),b.type="POST",b.contentType="application/x-www-form-urlencoded");a._ajax(b)};a._contactServer=function(b,e,c){return a._ajax({dataType:"text",type:"GET",
url:a._serverUrl+b,success:function(b){a._loadSuccess(b,e)},error:function(){a._loadError(c)},async:e?a._asynchronous:!1})};a._setQueryTerm=function(b,e){if(e&&b._hasOptions&&"http://"!=e.substring(0,7)){if(a._isDatabaseCall(e)){var c=e.substring(0,1);e=e.substring(1);"="==c&&(4==e.length&&"="==e.substring(0,1))&&(e=e.substring(1));var d=a._getElement(b,"select");if(d.options)for(var f=0;f<d.options.length;f++)d[f].value==c&&(d[f].selected=!0)}a._getElement(b,"query").value=e}};a._search=function(b,
e,c){1<arguments.length||(e=null);a._setQueryTerm(b,e);e||(e=a._getElement(b,"query").value);if(0==e.indexOf("!"))b._script(e);else{e&&(e=e.replace(/\"/g,""));b._showInfo(!1);var d;a._isDatabaseCall(e)?(d=e.substring(0,1),e=e.substring(1)):d=b._hasOptions?a._getElement(b,"select").value:"$";"="==d&&3==e.length&&(e="="+e);var f=d+e;e&&!(0>f.indexOf("?")&&f==b._thisJmolModel)&&(b._thisJmolModel=f,"$"==d||":"==d?b._jmolFileType="MOL":"="==d&&(b._jmolFileType="PDB"),b._searchDatabase(e,d,c))}};a._searchDatabase=
function(b,e,c,d){b._showInfo(!1);return 0<=e.indexOf("?")?(a._getInfoFromDatabase(b,c,e.split("?")[0]),!0):a.db._DirectDatabaseCalls[c]?(b._loadFile(c+e,d),!0):!1};a._syncBinaryOK="?";a._canSyncBinary=function(){if(self.VBArray)return a._syncBinaryOK=!1;if("?"!=a._syncBinaryOK)return a._syncBinaryOK;a._syncBinaryOK=!0;try{var b=new window.XMLHttpRequest;b.open("text","http://google.com",!1);b.hasOwnProperty("responseType")?b.responseType="arraybuffer":b.overrideMimeType&&b.overrideMimeType("text/plain; charset=x-user-defined")}catch(e){return System.out.println("JmolCore.js: synchronous binary file transfer is not available"),
a._syncBinaryOK=!1}return!0};a._binaryTypes=".gz .jpg .png .zip .jmol .bin .smol .spartan .mrc .pse".split(" ");a._isBinaryUrl=function(b){for(var e=a._binaryTypes.length;0<=--e;)if(0<=b.indexOf(a._binaryTypes[e]))return!0;return!1};a._getFileData=function(b){var e=a._isBinaryUrl(b)?"binary":"text",c="binary"==e&&!a._canSyncBinary();c&&0<=b.indexOf("pdb.gz")&&(b=b.replace(/pdb\.gz/,"pdb"),c=!1,e="text");var d=0<=b.indexOf("?POST?");0==b.indexOf("file:/")&&0!=b.indexOf("file:///")&&(b="file://"+b.substring(5));
var f=0>b.indexOf("://")||0==b.indexOf(document.location.protocol)&&0<=b.indexOf(document.location.host),h=a._isDirectCall(b);if(!f&&g.support.iecors||c||!f&&!h)return a._getRawDataFromServer("_",b,null,null,c,!0);e={dataType:e,async:!1};d?(e.type="POST",e.url=b.split("?POST?")[0],e.data=b.split("?POST?")[1]):e.url=b;b=a.$ajax(e);return!b.responseText||self.Clazz&&Clazz.instanceOf(b.response,self.ArrayBuffer)?b.response:b.responseText};a._isDirectCall=function(b){for(var e in a.db._DirectDatabaseCalls)if(0<=
e.indexOf(".")&&0<=b.indexOf(e))return!0;return!1};a._cleanFileData=function(b){return 0<=b.indexOf("\r")&&0<=b.indexOf("\n")?b.replace(/\r\n/g,"\n"):0<=b.indexOf("\r")?b.replace(/\r/g,"\n"):b};a._getFileType=function(b){var a=b.substring(0,1);if("$"==a||":"==a)return"MOL";if("="==a)return"="==b.substring(1,2)?"LCIF":"PDB";b=b.split(".").pop().toUpperCase();return b.substring(0,Math.min(b.length,3))};a._scriptLoad=function(b,a,c,d){var f=b._isJava||!b._noscript||1<c.length;f&&b._script("zap;set echo middle center;echo Retrieving data...");
if(!d)return!1;f?b._script('load "'+a+'"'+c):b._applet.viewer.openFile(a);b._checkDeferred("");return!0};a._loadFileAsynchronously=function(b,e){if(!a.featureDetection.hasFileReader)return b.setData("Local file reading is not enabled in your browser");e._localReader||(a.$after("#"+e._id+"_appletdiv",'<div id="ID" style="z-index:30000;position:absolute;background:#E0E0E0;left:10px;top:10px"><div style="margin:5px 5px 5px 5px;"><input type="file" id="ID_files" /><button id="ID_loadfile">load</button><button id="ID_cancel">cancel</button></div><div>'.replace(/ID/g,
e._id+"_localReader")),e._localReader=a.$(e,"localReader"));a.$appEvent(e,"localReader_loadfile","click");a.$appEvent(e,"localReader_loadfile","click",function(){var c=a.$(e,"localReader_files")[0].files[0],d=new FileReader;d.onloadend=function(d){d.target.readyState==FileReader.DONE&&(a.$appStyle(e,"localReader",{display:"none"}),b.setData(c.name,a._toBytes(d.target.result)))};d.readAsArrayBuffer(c)});a.$appEvent(e,"localReader_cancel","click");a.$appEvent(e,"localReader_cancel","click",function(){a.$appStyle(e,
"localReader",{display:"none"});b.setData(null,"#CANCELED#")});a.$appStyle(e,"localReader",{display:"block"})};a._toBytes=function(b){b=new Uint8Array(b);for(var a=Clazz.newByteArray(b.length,0),c=b.length;0<=--c;)a[c]=b[c];return a};a._doAjax=function(b,e,c){b=b.toString();if(null!=c)return a._saveFile(b,c);e&&(b+="?POST?"+e);e=a._getFileData(b);return a._processData(e,a._isBinaryUrl(b))};a._saveFile=function(b,e){var c=a._serverUrl;if(a._localFileSaveFunction&&a._localFileSaveFunction(b,e))return"OK";
if(!c)return"Jmol._serverUrl is not defined";var d="string"==typeof e,f=d?"":"base64";d||(e=J.io.Base64.getBase64(e).toString());b=b.substring(b.lastIndexOf("/")+1);d=0<=b.indexOf(".png")?"image/png":0<=b.indexOf(".jpg")?"image/jpg":"";a._formdiv||(a.$after("body",'<div id="__jsmolformdiv__" style="display:none">\t \t\t\t\t<form id="__jsmolform__" method="post" target="_blank" action="">\t \t\t\t\t<input name="call" value="saveFile"/>\t \t\t\t\t<input id="__jsmolmimetype__" name="mimetype" value=""/>\t \t\t\t\t<input id="__jsmolencoding__" name="encoding" value=""/>\t \t\t\t\t<input id="__jsmolfilename__" name="filename" value=""/>\t \t\t\t\t<textarea id="__jsmoldata__" name="data"></textarea>\t \t\t\t\t</form>\t \t\t\t\t</div>'),
a._formdiv="__jsmolform__");a.$attr(a._formdiv,"action",c+"?"+(new Date).getMilliseconds());a.$val("__jsmoldata__",e);a.$val("__jsmolfilename__",b);a.$val("__jsmolmimetype__",d);a.$val("__jsmolencoding__",f);a.$submit("__jsmolform__");a.$val("__jsmoldata__","");a.$val("__jsmolfilename__","");return"OK"};a._processData=function(b,e){"undefined"==typeof b&&(b="",e=!1);e&=a._canSyncBinary();if(!e)return J.util.SB.newS(b);var c;if(Clazz.instanceOf(b,self.ArrayBuffer))return a._toBytes(b);c=Clazz.newByteArray(b.length,
0);for(var d=b.length;0<=--d;)c[d]=b.charCodeAt(d)&255;return c};a._setConsoleDiv=function(b){self.Clazz&&Clazz.setConsoleDiv(b)};a._setJmolParams=function(b,e,c){for(var d in e)if(0<="'progressbar','progresscolor','boxbgcolor','boxfgcolor','allowjavascript','boxmessage',\t\t\t\t\t\t\t\t\t'messagecallback','pickcallback','animframecallback','appletreadycallback','atommovedcallback',\t\t\t\t\t\t\t\t\t'echocallback','evalcallback','hovercallback','language','loadstructcallback','measurecallback',\t\t\t\t\t\t\t\t\t'minimizationcallback','resizecallback','scriptcallback','statusform','statustext','statustextarea',\t\t\t\t\t\t\t\t\t'synccallback','usecommandthread'".indexOf("'"+
d.toLowerCase()+"'")&&("language"!=d||a.featureDetection.supportsLocalization()))c?b.put(d,!0===e[d]?Boolean.TRUE:!1===e[d]?Boolean.FALSE:e[d]):b[d]=e[d]};a._registerApplet=function(b,e){return window[b]=a._applets[b]=a._applets[e]=e};a._readyCallback=function(b,e,c,d){var f=b.split("_object")[0];a._applets[f]._readyCallback(b,e,c,d)};a._getWrapper=function(b,a){var c=b._height,d=b._width;if("string"!==typeof c||0>c.indexOf("%"))c+="px";if("string"!==typeof d||0>d.indexOf("%"))d+="px";var f="";b._coverImage&&
(f=' onclick="Jmol.coverApplet(ID, false)" title="'+b._coverTitle+'"',f='<div id="ID_coverdiv" style="backgoround-color:red;z-index:10000;width:100%;height:100%;display:inline;position:absolute;top:0px;left:0px"><image id="ID_coverimage" src="'+b._coverImage+'" style="width:100%;height:100%"'+f+"/>"+('<image id="ID_coverclickgo" src="'+b._j2sPath+'/img/play_make_live.jpg" style="width:25px;height:25px;position:absolute;bottom:10px;left:10px;z-index:10001;opacity:0.5;"'+f+" />")+"</div>");return(a?
'<div id="ID_appletinfotablediv" style="width:Wpx;height:Hpx;position:relative">IMG<div id="ID_appletdiv" style="z-index:9999;width:100%;height:100%;position:absolute:top:0px;left:0px;">':'</div><div id="ID_infotablediv" style="width:100%;height:100%;position:absolute;top:0px;left:0px">\t\t\t<div id="ID_infoheaderdiv" style="height:20px;width:100%;background:yellow;display:none"><span id="ID_infoheaderspan"></span><span id="ID_infocheckboxspan" style="position:absolute;text-align:right;right:1px;"><a href="javascript:Jmol.showInfo(ID,false)">[x]</a></span></div>\t\t\t<div id="ID_infodiv" style="position:absolute;top:20px;bottom:0;width:100%;height:95%;overflow:auto"></div></div></div>').replace(/IMG/,
f).replace(/Hpx/g,c).replace(/Wpx/g,d).replace(/ID/g,b._id)};a._documentWrite=function(b){if(a._document){if(a._isXHTML&&!a._XhtmlElement){var e=document.getElementsByTagName("script");a._XhtmlElement=e.item(e.length-1);a._XhtmlAppendChild=!1}a._XhtmlElement?a._domWrite(b):a._document.write(b);return null}return b};a._domWrite=function(b){for(var e=[0];e[0]<b.length;){var c=a._getDomElement(b,e);if(!c)break;a._XhtmlAppendChild?a._XhtmlElement.appendChild(c):a._XhtmlElement.parentNode.insertBefore(c,
_jmol.XhtmlElement)}};a._getDomElement=function(b,a){var c=document.createElement("span");c.innerHTML=b;a[0]=b.length;return c};a._setObject=function(b,a,c){b._id=a;b.__Info={};for(var d in c)b.__Info[d]=c[d];b._width=c.width;b._height=c.height;b._noscript=!b._isJava&&c.noscript;b._console=c.console;b._console||(b._console=b._id+"_infodiv");"none"==b._console&&(b._console=null);b._color=c.color?c.color.replace(/0x/,"#"):"#FFFFFF";b._disableInitialConsole=c.disableInitialConsole;b._noMonitor=c.disableJ2SLoadMonitor;
b._j2sPath=c.j2sPath;b._deferApplet=c.deferApplet;b._deferUncover=c.deferUncover;b._coverImage=!b._isJava&&c.coverImage;b._isCovered=!!b._coverImage;b._coverScript=c.coverScript;b._coverTitle=c.coverTitle;b._coverTitle||(b._coverTitle=b._deferApplet?"activate 3D model":"3D model is loading...");b._containerWidth=b._width+(b._width==parseFloat(b._width)?"px":"");b._containerHeight=b._height+(b._height==parseFloat(b._height)?"px":"");b._info="";b._infoHeader=b._jmolType+' "'+b._id+'"';b._hasOptions=
c.addSelectionOptions;b._defaultModel=c.defaultModel;b._readyScript=c.script?c.script:"";b._readyFunction=c.readyFunction;b._coverImage&&!b._deferApplet&&(b._readyScript+=";javascript "+a+"._displayCoverImage(false)");b._src=c.src};a._addDefaultInfo=function(b,a){for(var c in a)"undefined"==typeof b[c]&&(b[c]=a[c])};a._syncedApplets=[];a._syncedCommands=[];a._syncedReady=[];a._syncReady=!1;a._isJmolJSVSync=!1;a._setReady=function(b){a._syncedReady[b]=1;for(var c=0,d=0;d<a._syncedApplets.length;d++){if(a._syncedApplets[d]==
b._id)a._syncedApplets[d]=b,a._syncedReady[d]=1;else if(!a._syncedReady[d])continue;c++}c==a._syncedApplets.length&&a._setSyncReady()};a._setDestroy=function(b){a.featureDetection.allowDestroy&&a.$windowOn("beforeunload",function(){a._destroy(b)})};a._destroy=function(b){try{b._applet&&b._applet.destroy();b._applet=null;a._unsetMouse(b._canvas);b._canvas=null;for(var c=0,d=0;d<a._syncedApplets.length;d++)a._syncedApplets[d]==b&&(a._syncedApplets[d]=null),a._syncedApplets[d]&&c++;0<c||a._clearVars()}catch(f){}};
a._setSyncReady=function(){a._syncReady=!0;for(var b="",c=0;c<a._syncedApplets.length;c++)a._syncedCommands[c]&&(b+="Jmol.script(Jmol._syncedApplets["+c+"], Jmol._syncedCommands["+c+"]);");setTimeout(b,50)};a._mySyncCallback=function(b,c){if(!a._syncReady||!a._isJmolJSVSync)return 1;for(var d=0;d<a._syncedApplets.length;d++)0<=c.indexOf(a._syncedApplets[d]._syncKeyword)&&a._syncedApplets[d]._syncScript(c);return 0};a._getElement=function(b,a){return document.getElementById(b._id+"_"+a)||{}};a._evalJSON=
function(b,a){b+="";if(!b)return[];if("{"!=b.charAt(0))return 0<=b.indexOf(" | ")&&(b=b.replace(/\ \|\ /g,"\n")),b;var c=(new Function("return "+b))();return!c?null:a&&void 0!=c[a]?c[a]:c};a._sortMessages=function(b){function a(b,c){return b[0]<c[0]?1:b[0]>c[0]?-1:0}if(!b||"object"!=typeof b)return[];for(var c=[],d=b.length-1;0<=d;d--)for(var f=0,g=b[d].length;f<g;f++)c[c.length]=b[d][f];if(0!=c.length)return c=c.sort(a)};a._jsGetMouseModifiers=function(b){var a=0;switch(b.button){case 0:a=16;break;
case 1:a=8;break;case 2:a=4}b.shiftKey&&(a+=1);b.altKey&&(a+=8);b.ctrlKey&&(a+=2);return a};a._jsGetXY=function(b,c){if(!b.applet._ready||a._touching&&0>c.type.indexOf("touch"))return!1;c.preventDefault();var d=a.$offset(b.id),f,g=c.originalEvent;a._mousePageX=c.pageX;a._mousePageY=c.pageY;g.targetTouches&&g.targetTouches[0]?(f=g.targetTouches[0].pageX-d.left,d=g.targetTouches[0].pageY-d.top):g.changedTouches?(f=g.changedTouches[0].pageX-d.left,d=g.changedTouches[0].pageY-d.top):(f=c.pageX-d.left,
d=c.pageY-d.top);return void 0==f?null:[Math.round(f),Math.round(d),a._jsGetMouseModifiers(c)]};a._gestureUpdate=function(b,c){c.stopPropagation();c.preventDefault();var d=c.originalEvent;switch(c.type){case "touchstart":a._touching=!0;break;case "touchend":a._touching=!1}if(!d.touches||2!=d.touches.length)return!1;switch(c.type){case "touchstart":b._touches=[[],[]];break;case "touchmove":var f=a.$offset(b.id),g=b._touches[0],h=b._touches[1];g.push([d.touches[0].pageX-f.left,d.touches[0].pageY-f.top]);
h.push([d.touches[1].pageX-f.left,d.touches[1].pageY-f.top]);d=g.length;3<d&&(g.shift(),h.shift());2<=d&&b.applet._processGesture(b._touches)}return!0};a._jsSetMouse=function(b){a.$bind(b,"mousedown touchstart",function(c){c.stopPropagation();c.preventDefault();b.isDragging=!0;if("touchstart"==c.type&&a._gestureUpdate(b,c))return!1;a._setConsoleDiv(b.applet._console);var d=a._jsGetXY(b,c);if(!d)return!1;2!=c.button&&b.applet._popups&&a.Menu.hidePopups(b.applet._popups);b.applet._processEvent(501,
d);return!1});a.$bind(b,"mouseup touchend",function(c){c.stopPropagation();c.preventDefault();b.isDragging=!1;if("touchend"==c.type&&a._gestureUpdate(b,c))return!1;c=a._jsGetXY(b,c);if(!c)return!1;b.applet._processEvent(502,c);return!1});a.$bind(b,"mousemove touchmove",function(c){c.stopPropagation();c.preventDefault();if("touchmove"==c.type&&a._gestureUpdate(b,c))return!1;c=a._jsGetXY(b,c);if(!c)return!1;b.isDragging||(c[2]=0);b.applet._processEvent(b.isDragging?506:503,c);return!1});a.$bind(b,"DOMMouseScroll mousewheel",
function(c){c.stopPropagation();c.preventDefault();b.isDragging=!1;var d=c.originalEvent,d=d.detail?d.detail:d.wheelDelta;c=a._jsGetMouseModifiers(c);b.applet._processEvent(-1,[0>d?-1:1,0,c]);return!1});a.$bind(b,"contextmenu",function(){return!1});a.$bind(b,"mouseout",function(){b.applet._applet&&b.applet._applet.viewer.startHoverWatcher(!1);b.isDragging=!1});a.$bind(b,"mouseenter",function(c){b.applet._applet&&b.applet._applet.viewer.startHoverWatcher(!0);if(0===c.buttons||0===c.which){b.isDragging=
!1;c=a._jsGetXY(b,c);if(!c)return!1;b.applet._processEvent(502,c)}});b.applet._is2D&&a.$resize(function(){b.applet&&b.applet._resize()});a.$bind("body","mouseup touchend",function(){b.applet&&(b.isDragging=!1)})};a._jsUnsetMouse=function(b){b.applet=null;a.$bind(b,"mousedown touchstart mousemove touchmove mouseup touchend DOMMouseScroll mousewheel contextmenu mouseout mouseenter",null)};a._setDraggable=function(b){b=b.prototype;b.setContainer=function(b){this.container=b;this.ignoreMouse=this.isDragging=
!1;var c=this;b.bind("mousedown touchstart",function(b){if(c.ignoreMouse)return c.ignoreMouse=!1,!0;c.isDragging=!0;c.pageX=b.pageX;c.pageY=b.pageY;return!1});b.bind("mousemove touchmove",function(b){if(c.isDragging)return c.mouseMove(b),!1});b.bind("mouseup touchend",function(b){c.mouseUp(b)})};b.mouseUp=function(b){if(this.isDragging)return this.pageX0+=b.pageX-this.pageX,this.pageY0+=b.pageY-this.pageY,this.isDragging=!1};b.setPosition=function(){if(null===a._mousePageX){var b=a.$offset(this.applet._id+
"_"+(this.applet._is2D?"canvas2d":"canvas"));a._mousePageX=b.left;a._mousePageY=b.top}this.pageX0=a._mousePageX;this.pageY0=a._mousePageY;this.container.css({top:a._mousePageY+"px",left:a._mousePageX+"px"})};b.mouseMove=function(b){this.isDragging&&this.container.css({top:this.pageY0+(b.pageY-this.pageY)+"px",left:this.pageX0+(b.pageX-this.pageX)+"px"})};b.dragBind=function(b){this.container.unbind("mousemoveoutjsmol");this.container.unbind("touchmoveoutjsmol");this.container.unbind("mouseupoutjsmol");
this.container.unbind("touchendoutjsmol");if(b){var c=this;this.container.bind("mousemoveoutjsmol touchmoveoutjsmol",function(b,a,d){c.mouseMove(d)});this.container.bind("mouseupoutjsmol touchendoutjsmol",function(b,a,d){c.mouseUp(d)})}}}})(Jmol,jQuery);Jmol._grabberOptions=[["$","NCI(small molecules)"],[":","PubChem(small molecules)"]];Jmol.say=function(a){alert(a)};
Jmol._TMApplet=function(a,g,c){this._syncId=(""+Math.random()).substring(3);this._id=a;this._is2D=!0;this._isJava=!1;this._ready=!0;this._mouseDown=!1;this._jmolType="Jmol._Canvas2D (TwirlyMol)";if(c)return this;this._createCanvas(a,g);return this};
Jmol._TMApplet._getApplet=function(a,g,c){if(!Jmol.featureDetection.allowHTML5)return null;c||(c=!1);g||(g={});Jmol._addDefaultInfo(g,{color:"#FFFFFF",width:300,height:300,addSelectionOptions:!1,serverURL:"http://chemapps.stolaf.edu/jmol/jsmol/jsmol.php",defaultModel:"",readyFunction:null,use:"HTML5",bondWidth:5,shadeAtoms:!1,zoomScaling:1.5,pinchScaling:2,mouseDragFactor:0.5,touchDragFactor:0.15,multipleBondSpacing:4,spinRateX:0,spinRateY:0.5,spinFPS:20,spin:!1,noscript:!0,debug:!1});g=new Jmol._TMApplet(a,
g,c);return c?g:Jmol._registerApplet(a,g)};Jmol.getTMApplet=Jmol._TMApplet._getApplet;
(function(a){a._CPK="#FF1493 #FFFFFF #D9FFFF #CC80FF #C2FF00 #FFB5B5 #909090 #3050F8 #FF0D0D #90E050 #B3E3F5 #AB5CF2 #8AFF00 #BFA6A6 #F0C8A0 #FF8000 #FFFF30 #1FF01F #80D1E3 #8F40D4 #3DFF00 #E6E6E6 #BFC2C7 #A6A6AB #8A99C7 #9C7AC7 #E06633 #F090A0 #50D050 #C88033 #7D80B0 #C28F8F #668F8F #BD80E3 #FFA100 #A62929 #5CB8D1 #702EB0 #00FF00 #94FFFF #94E0E0 #73C2C9 #54B5B5 #3B9E9E #248F8F #0A7D8C #006985 #C0C0C0 #FFD98F #A67573 #668080 #9E63B5 #D47A00 #940094 #429EB0 #57178F #00C900".split(" ");a._elem="X H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es".split(" ");
a._elemNo={};var g=a.prototype;g.spin=function(c){this.__Info.spin=c;this._spin(c)};g._spin=function(c){this._spinThread&&clearTimeout(this._spinThread);if(0==this.spinFPS||0==this.spinRateX&&0==this.spinRateY)c=!1;if(c){var a=this;c=1E3/this.spinFPS;this._mouseDown||(this._rotate(this.spinRateY,this.spinRateX),this._draw());this._spinThread=setTimeout(function(){a._spin(!0)},c)}};g._initParams=function(){this.zoom=this.__Info.defaultZoom||100;this.doSpin=this.__Info.spin||!1;this.center2D=[this._canvas.width/
2,this._canvas.height/2,0];this._getCenterAndRadius();this.rotation=new a.M3;this.shadeAtoms=!1;this._setParams()};g._setParams=function(){this.bondWidth=this.__Info.bondWidth||5;this.zoomScaling=this.__Info.zoomScaling||1.5;this.pinchScaling=this.__Info.pinchScaling||1;this.mouseDragFactor=this.__Info.mouseDragFactor||0.5;this.touchDragFactor=this.__Info.touchDragFactor||0.15;this.multipleBondSpacing=this.__Info.multipleBondSpacing||4;this.spinRateX=this.__Info.spinRateX||0;this.spinRateY=this.__Info.spinRateY||
0;this.spinFPS=this.__Info.spinFPS||0;var c=this.shadeAtoms;(this.shadeAtoms=this.__Info.shadeAtoms||!1)&&!c&&this._setAtomShades()};g._setAtomShades=function(){if(this.atoms)for(var c=this.atoms.length;0<=--c;)this.atoms[c].color50=this._getColor(this.atoms[c].color,0.5)};g._createCanvas=function(c,a){Jmol._setObject(this,c,a);this._color=this._color.replace(/0x/,"#");var f=Jmol._getWrapper(this,!0);Jmol._document?(Jmol._documentWrite(f),this._createCanvas2d(!1),f=""):f+='<script type="text/javascript">'+
c+"._createCanvas2d(false)\x3c/script>";f+=Jmol._getWrapper(this,!1);a.addSelectionOptions&&(f+=Jmol._getGrabberOptions(this,""));Jmol._debugAlert&&!Jmol._document&&alert(f);this._code=Jmol._documentWrite(f)};g._readyCallback=function(c,a,f,b){f&&(Jmol._setDestroy(this),this._ready=!0,c=this._readyScript,this._applet=b,this._defaultModel?this._search(this._defaultModel,c?";"+c:""):this._src&&this._loadFile(this._src),this._showInfo(!0),this._showInfo(!1),this._readyFunction&&this._readyFunction(this),
Jmol._setReady(this))};g._createCanvas2d=function(c){var a=document.createElement("canvas"),f=Jmol.$(this,"appletdiv");c&&(f[0].removeChild(this._canvas),Jmol._jsUnsetMouse(this._canvas));c=Math.round(f.width());var b=Math.round(f.height());a.applet=this;this._canvas=a;a.style.width="100%";a.style.height="100%";a.width=c;a.height=b;a.id=this._id+"_canvas2d";f.append(a);setTimeout(this._id+"._start()",10)};g._start=function(){Jmol._jsSetMouse(this._canvas);this._defaultModel?Jmol._search(this,this._defaultModel):
this._src&&this._loadFile(this._src);this._showInfo(!0);this._showInfo(!1)};g._search=function(c,a){Jmol._search(this,c,a)};g._searchDatabase=function(c,a,f){this._showInfo(!1);if(0<=c.indexOf("?"))Jmol._getInfoFromDatabase(this,a,c.split("?")[0]);else{var b=a+c;if(Jmol.db._DirectDatabaseCalls[a])this._loadFile(b,f);else{var e=this;Jmol._getRawDataFromServer(a,c,function(b){e._loadModel(b,"")})}}};g._loadModel=function(c){this._spin(!1);"''"==c&&(c=this._mol);c?(this._parse(c),this._initParams(),
this._draw(),this._showInfo(!1),this.doSpin&&this._spin(!0)):alert("No model data.")};g._showInfo=function(c){Jmol._getElement(this,"infoheaderspan").innerHTML=this._infoHeader;this._info&&(Jmol._getElement(this,"infodiv").innerHTML=this._info);!this._isInfoVisible!=!c&&(this._isInfoVisible=c,this._infoObject?this._infoObject._showInfo(c):(Jmol._getElement(this,"infotablediv").style.display=c?"block":"none",Jmol._getElement(this,"infoheaderdiv").style.display=c?"block":"none"),this._show(!c))};g._show=
function(c){Jmol._getElement(this,"appletdiv").style.display=c?"block":"none";c&&this._draw()};g._resize=function(){var c="__resizeTimeout_"+this._id;Jmol[c]&&clearTimeout(Jmol[c]);var a=this;Jmol[c]=setTimeout(function(){a._draw();Jmol[c]=null},100)};g._canScript=function(){return!1};g._loadFile=function(c){this._showInfo(!1);this._thisJmolModel=c;var a=this;Jmol._loadFileData(this,c,function(c){a._loadModel(c)})};g._processEvent=function(c,a){switch(c){case 502:case 503:this._mouseDown=!1;default:return;
case 501:this._mouseX=a[0];this._mouseY=a[1];this._mouseDown=!0;return;case 506:var f=a[0]-this._mouseX,b=a[1]-this._mouseY,f=0>f?-1:0<f?1:0,b=0>b?-1:0<b?1:0;switch(a[2]){case 17:this._zoomBy(b);break;case 24:this.center2D[0]+=f;this.center2D[1]+=b;break;default:this._rotate(f,b)}this._mouseX=a[0];this._mouseY=a[1];break;case -1:this._zoomBy(a[1])}this._draw()};g._processGesture=function(c){if(!(2>c[0].length)){var d=c[0],f=c[1],b=d[0],e=d[f.length-1];c=b[0];var g=e[0],b=b[1],e=e[1],j=[g-c,e-b,0],
k=a._length(j),h=f[0],l=f[f.length-1],f=h[0],p=l[0],h=h[1],l=l[1],m=[p-f,l-h,0],q=a._length(m);3>k||3>q||(a._scale(j,1/k),a._scale(m,1/q),j=a._dot(j,m),0.8<j?(c=Math.round(g-d[d.length-2][0]),d=Math.round(e-d[d.length-2][1]),this.center2D[0]+=c,this.center2D[1]+=d):-0.8>j&&(j=[f-c,h-b,0],m=[p-g,l-e,0],d=a._length(m)-a._length(j),this.zoom+=(0>d?-1:1)*this.pinchScaling),this._draw())}};g._zoomBy=function(c){this.zoom+=c*this.zoomScaling;5>this.zoom&&(this.zoom=5);500<this.zoom&&(this.zoom=500)};g._getRotationScaling=
function(){return[1/Math.max(this._canvas.width,500)*this.mouseDragFactor*a.deg_per_radian,1/Math.max(this._canvas.height,500)*this.mouseDragFactor*a.deg_per_radian]};g._rotate=function(c,d){var f=this._getRotationScaling();d&&(a._m3.rotX(d*f[1]),this.rotation.mul(a._m3));c&&(a._m3.rotY(c*f[0]),this.rotation.mul(a._m3))};g._getCenterAndRadius=function(){Math.min(this._canvas.width,this._canvas.height);for(var c=[999999,999999,999999],d=[-999999,-999999,-999999],f=this.atoms.length;0<=--f;)for(var b=
3;0<=--b;){var e=this.atoms[f].xyz[b];e<c[b]&&(c[b]=e);e>d[b]&&(d[b]=e)}e=[0,0,0];for(b=3;0<=--b;)e[b]=(d[b]+c[b])/2;c=0;for(f=this.atoms.length;0<=--f;)d=this.atoms[f],d=a._distance(d.xyz,e)+(1==d.elemNo?1:1.5),d>c&&(c=d);this.center=e;this.modelRadius=0==c?10:c};g._setScreenCoords=function(){for(var c=this.center,a=this.rotation,f=this.center2D,b=Math.min(this._canvas.width,this._canvas.height)/2/this.modelRadius*this.zoom/100,e=this.atoms.length;0<=--e;){var g=this.atoms[e];this._transform(g.xyz,
g.sxyz,c,a,b,f);g.srad=b*g.radius}for(e=this.bonds.length;0<=--e;)g=this.bonds[e],this._transform(g.xyz,g.sxyz,c,a,b,f),this._transform(g.pts[0],g.spts[0],c,a,b,f),this._transform(g.pts[1],g.spts[1],c,a,b,f)};g._transform=function(c,d,f,b,e,g){for(var j=a._temp1,k=a._temp2,h=3;0<=--h;)j[h]=(c[h]-f[h])*e;b.transform(j,k);k[1]=-k[1];k[2]=-k[2];for(h=3;0<=--h;)d[h]=k[h]+g[h]};g._parse=function(c){this._parseSDF(c)};g._parseSDF=function(c){this._mol=c;if(!a._elemNo.H)for(var d=a._elem.length;0<=--d;)a._elemNo[a._elem[d]]=
d;c=c.split("\n");var f=3,b=c[f++];this.nAtoms=parseFloat(b.substring(0,3));this.nBonds=parseFloat(b.substring(3,6));this.atoms=Array(this.nAtoms);this.bonds=Array(this.nBonds);this.elements=Array(this.nAtoms+this.nBonds);for(var e=0,g,j,k,d=0;d<this.nAtoms;d++){b=c[f++];g=parseFloat(b.substring(0,10));j=parseFloat(b.substring(10,20));k=parseFloat(b.substring(20,30));var b=b.substring(31,34).replace(/\s+/g,""),b=a._elemNo[b]||0,h=1==b?0.23:0.35,l=a._CPK[b]||a._CPK[0];this.elements[e++]=this.atoms[d]=
{type:0,elemNo:b,xyz:[g,j,k],sxyz:[0,0,0],radius:h,color:l,color50:l}}for(d=0;d<this.nBonds;d++){b=c[f++];g=this.atoms[parseFloat(b.substring(0,3))-1];j=this.atoms[parseFloat(b.substring(3,6))-1];k=Math.abs(parseFloat(b.substring(6,9)));switch(k){case 4:case 5:case 6:case 8:k=1;break;case 7:k=2}b=a._getPointAlong(g.xyz,j.xyz,0.5);l=a._distance(g.xyz,b);h=g.radius<l?a._getPointAlong(g.xyz,b,g.radius/l):[0,0,99999];l=j.radius<l?a._getPointAlong(j.xyz,b,j.radius/l):[0,0,99999];this.elements[e++]=this.bonds[d]=
{type:1,atoms:[g,j],xyz:b,pts:[h,l],sxyz:[0,0,0],spts:[[0,0,0],[0,0,0]],order:k,color:0}}};g._getColor=function(c,a){"#FFFFFF"==c&&(c="#D0D0D0");var f=parseInt("0x"+c.substring(1),16),b=f>>16&255,e=f>>8&255,f=f&255;255!=b&&(b+=Math.floor((255-b)*a));255!=e&&(e+=Math.floor((255-e)*a));255!=f&&(f+=Math.floor((255-f)*a));b="000000"+(b<<16|e<<8|f).toString(16);return"#"+b.substring(b.length-6,b.length)};g._draw=function(){if(this.atoms){this._setParams();this._setScreenCoords();var c=this.elements;c.sort(a._zorder);
var d=this._canvas.getContext("2d");d.fillStyle=this._color;d.fillRect(0,0,this._canvas.width,this._canvas.height);for(var f=c.length;0<=--f;){var b=c[f];0==b.type?this._drawAtom(d,b):this._drawBond(d,b)}}};g._drawAtom=function(c,d){c.beginPath();if(this.shadeAtoms){var f=d.srad/4,f=c.createRadialGradient(d.sxyz[0]-f,d.sxyz[1]-f,f,d.sxyz[0],d.sxyz[1],d.srad);f.addColorStop(0,d.color50);f.addColorStop(1,"#FFFFFF"==d.color?"#D0D0D0":d.color);c.fillStyle=f;c.arc(d.sxyz[0],d.sxyz[1],d.srad,0,a._pi2);
c.fill()}else c.fillStyle=d.color,c.arc(d.sxyz[0],d.sxyz[1],d.srad,0,a._pi2),c.fill(),c.strokeStyle="#000000",c.lineWidth=1,c.stroke()};g._drawBond=function(c,a){99999!=a.pts[0][2]&&this._drawBondLines(c,a,a.spts[0],a.atoms[0].color);99999!=a.pts[1][2]&&this._drawBondLines(c,a,a.spts[1],a.atoms[1].color)};g._drawBondLines=function(c,d,f,b){var e=a._temp;e.width=this.bondWidth;e.color=d.color?d.color:b;if(1==d.order)e.pt1=f,e.pt2=d.sxyz,this._drawLine(c,e);else{e.pt1=a._temp1;e.pt2=a._temp2;e.pta=
f;e.ptb=d.sxyz;e.dx=e.ptb[0]-e.pta[0];e.dy=e.ptb[1]-e.pta[1];e.mag2d=Math.round(Math.sqrt(e.dx*e.dx+e.dy*e.dy));e.bondOrder=d.order;for(this._resetAxisCoordinates(e);0<e.bondOrder;)this._drawLine(c,e),e.bondOrder--,this._stepAxisCoordinates(e)}};g._drawLine=function(c,a){c.beginPath();c.strokeStyle=a.color;c.moveTo(a.pt1[0],a.pt1[1]);c.lineTo(a.pt2[0],a.pt2[1]);c.lineWidth=a.width;c.stroke()};g._resetAxisCoordinates=function(a){var d=a.mag2d>>3;1!=this.multipleBondSpacing&&(d*=this.multipleBondSpacing);
d=a.width+d;a.dxStep=Math.round(d*a.dy/a.mag2d);a.dyStep=Math.round(d*-a.dx/a.mag2d);a.pt1[0]=a.pta[0];a.pt1[1]=a.pta[1];a.pt2[0]=a.ptb[0];a.pt2[1]=a.ptb[1];d=a.bondOrder-1;a.pt1[0]-=Math.round(a.dxStep*d/2);a.pt1[1]-=Math.round(a.dyStep*d/2);a.pt2[0]-=Math.round(a.dxStep*d/2);a.pt2[1]-=Math.round(a.dyStep*d/2)};g._stepAxisCoordinates=function(a){a.pt1[0]+=a.dxStep;a.pt1[1]+=a.dyStep;a.pt2[0]+=a.dxStep;a.pt2[1]+=a.dyStep};a._distance=function(a,d){for(var f=0,b=3;0<=--b;)var e=a[b]-d[b],f=f+e*e;return Math.sqrt(f)};
a._dot=function(a,d){for(var f=0,b=3;0<=--b;)f+=a[b]*d[b];return f};a._setPt=function(a,d){for(var f=3;0<=--f;)d[f]=a[f];return d};a._scale=function(a,d){for(var f=3;0<=--f;)a[f]*=d};a._length=function(a){for(var d=0,f=3;0<=--f;)d+=a[f]*a[f];return Math.sqrt(d)};a._getPointAlong=function(a,d,f){return[(d[0]-a[0])*f+a[0],(d[1]-a[1])*f+a[1],(d[2]-a[2])*f+a[2]]};a._zorder=function(a,d){var f=a.sxyz[2],b=d.sxyz[2];return f<b?-1:f>b?1:0};a.M3=function(){this.m00=1;this.m10=this.m02=this.m01=0;this.m11=
1;this.m21=this.m20=this.m12=0;this.m22=1};a.M3.prototype.set=function(a,d,f,b,e,g,j,k,h){this.m00=a;this.m01=d;this.m02=f;this.m10=b;this.m11=e;this.m12=g;this.m20=j;this.m21=k;this.m22=h};a.M3.prototype.transform=function(a,d){d[0]=this.m00*a[0]+this.m01*a[1]+this.m02*a[2];d[1]=this.m10*a[0]+this.m11*a[1]+this.m12*a[2];d[2]=this.m20*a[0]+this.m21*a[1]+this.m22*a[2]};a.M3.prototype.rotX=function(a){var d=Math.cos(a);a=Math.sin(a);this.m00=1;this.m10=this.m02=this.m01=0;this.m11=d;this.m12=-a;this.m20=
0;this.m21=a;this.m22=d};a.M3.prototype.rotY=function(a){var d=Math.cos(a);a=Math.sin(a);this.m00=d;this.m01=0;this.m02=a;this.m10=0;this.m11=1;this.m12=0;this.m20=-a;this.m21=0;this.m22=d};a.M3.prototype.mul=function(a){this.set(a.m00*this.m00+a.m01*this.m10+a.m02*this.m20,a.m00*this.m01+a.m01*this.m11+a.m02*this.m21,a.m00*this.m02+a.m01*this.m12+a.m02*this.m22,a.m10*this.m00+a.m11*this.m10+a.m12*this.m20,a.m10*this.m01+a.m11*this.m11+a.m12*this.m21,a.m10*this.m02+a.m11*this.m12+a.m12*this.m22,a.m20*
this.m00+a.m21*this.m10+a.m22*this.m20,a.m20*this.m01+a.m21*this.m11+a.m22*this.m21,a.m20*this.m02+a.m21*this.m12+a.m22*this.m22)};a._pi2=2*Math.PI;a.deg_per_radian=180/Math.PI;a._z3=[0,0,0];a._temp1=[0,0,0];a._temp2=[0,0,0];a._temp={};a._m3=new a.M3})(Jmol._TMApplet);
