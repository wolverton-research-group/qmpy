<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Materials &mdash; qmpy 0.4.9 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="qmpy 0.4.9 documentation" href="index.html" />
    <link rel="up" title="Data models" href="models.html" />
    <link rel="next" title="Calculations" href="calculations.html" />
    <link rel="prev" title="Data models" href="models.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="calculations.html" title="Calculations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="models.html" title="Data models"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">qmpy 0.4.9 documentation</a> &raquo;</li>
          <li><a href="models.html" accesskey="U">Data models</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-qmpy">
<span id="materials"></span><h1>Materials<a class="headerlink" href="#module-qmpy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="qmpy.Structure">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Structure</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure model. Principal attributes are a lattice and basis set.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Entry</span></tt> via entry</div>
<div class="line"><a class="reference internal" href="#qmpy.Atom" title="qmpy.Atom"><tt class="xref py py-mod docutils literal"><span class="pre">Atom</span></tt></a> via atom_set: Atoms in the structure. More commonly</div>
<div class="line-block">
<div class="line">handled by the managed attributed <cite>atoms</cite>.</div>
</div>
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Calculation" title="qmpy.Calculation"><tt class="xref py py-mod docutils literal"><span class="pre">Calculation</span></tt></a> via calculated. Calculation objects</div>
<div class="line-block">
<div class="line">that the structure is an <em>output</em> from.</div>
</div>
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Calculation" title="qmpy.Calculation"><tt class="xref py py-mod docutils literal"><span class="pre">Calculation</span></tt></a> via calculation_set. Returns calculation</div>
<div class="line-block">
<div class="line">objects that the structure is an <em>input</em> to.</div>
</div>
<div class="line"><a class="reference internal" href="#qmpy.Composition" title="qmpy.Composition"><tt class="xref py py-mod docutils literal"><span class="pre">Composition</span></tt></a> via composition.</div>
<div class="line"><a class="reference internal" href="#qmpy.Element" title="qmpy.Element"><tt class="xref py py-mod docutils literal"><span class="pre">Element</span></tt></a> via element_set</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.Spacegroup" title="qmpy.Spacegroup"><tt class="xref py py-mod docutils literal"><span class="pre">Spacegroup</span></tt></a> via spacegroup</div>
<div class="line"><a class="reference internal" href="#qmpy.Species" title="qmpy.Species"><tt class="xref py py-mod docutils literal"><span class="pre">Species</span></tt></a> via species_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Prototype" title="qmpy.Prototype"><tt class="xref py py-mod docutils literal"><span class="pre">Prototype</span></tt></a> via prototype. If the structure belongs to a</div>
<div class="line-block">
<div class="line">prototypical structure, it is referred to here.</div>
</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Reference</span></tt> Original literature reference.</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">MetaData</span></tt> via meta_data</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line"><strong>Identification</strong></div>
<div class="line">id</div>
<div class="line">label: key in the Entry.structures dictionary.</div>
<div class="line">natoms: Number of atoms.</div>
<div class="line">nsites: Number of sites.</div>
<div class="line">ntypes: Number of elements.</div>
<div class="line">measured: Experimentally measured structure?</div>
<div class="line">source: Name for source.</div>
<div class="line"><br /></div>
<div class="line"><strong>Lattice</strong></div>
<div class="line">x1, x2, x3</div>
<div class="line">y1, y2, y3</div>
<div class="line">z1, z2, z3: Lattice vectors of the cell. Accessed via <cite>cell</cite>.</div>
<div class="line">volume</div>
<div class="line">volume_pa</div>
<div class="line"><br /></div>
<div class="line"><strong>Calculated properties</strong></div>
<div class="line">delta_e: Formation energy (eV/atom)</div>
<div class="line">meta_stability: Distance from the convex hull (eV/atom)</div>
<div class="line">energy: Total DFT energy (eV/FU)</div>
<div class="line">energy_pa: Total DFT energy (eV/atom)</div>
<div class="line">magmom: Total magnetic moment (&amp;Mu;&lt;sub&gt;b&lt;/sub&gt;)</div>
<div class="line">magmom_pa: Magnetic moment per atom.</div>
<div class="line">sxx, sxy, syy</div>
<div class="line">syx, szx, szz: Stresses on the cell. Accessed via <cite>stresses</cite>.</div>
</div>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;/io/files/POSCAR_FCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">magmoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">forces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">stresses</span>
</pre></div>
</div>
<dl class="method">
<dt id="qmpy.Structure.add_atom">
<tt class="descname">add_atom</tt><big>(</big><em>atom</em>, <em>tol=0.01</em><big>)</big><a class="headerlink" href="#qmpy.Structure.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds <cite>atom</cite> to the structure if it isn&#8217;t already contained.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.atom_types">
<tt class="descname">atom_types</tt><a class="headerlink" href="#qmpy.Structure.atom_types" title="Permalink to this definition">¶</a></dt>
<dd><p>List of atomic symbols, length equal to number of atoms.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.atomic_numbers">
<tt class="descname">atomic_numbers</tt><a class="headerlink" href="#qmpy.Structure.atomic_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>List of atomic numbers, length equal to number of atoms.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.atoms">
<tt class="descname">atoms</tt><a class="headerlink" href="#qmpy.Structure.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <tt class="docutils literal"><span class="pre">Atoms</span></tt> in the structure.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.cartesian_coords">
<tt class="descname">cartesian_coords</tt><a class="headerlink" href="#qmpy.Structure.cartesian_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return atomic positions in cartesian coordinates.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.cell">
<tt class="descname">cell</tt><a class="headerlink" href="#qmpy.Structure.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Lattice vectors, 3x3 numpy.ndarray.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.comment_objects">
<tt class="descname">comment_objects</tt><a class="headerlink" href="#qmpy.Structure.comment_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of comments (MetaData objects of type comment)</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.comp">
<tt class="descname">comp</tt><a class="headerlink" href="#qmpy.Structure.comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Composition dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.compare">
<tt class="descname">compare</tt><big>(</big><em>other</em>, <em>tol=0.01</em>, <em>atom_tol=10</em>, <em>volume=False</em>, <em>allow_distortions=False</em>, <em>check_spacegroup=False</em>, <em>wildcard=None</em><big>)</big><a class="headerlink" href="#qmpy.Structure.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Credit to K. Michel for the algorithm.</p>
<ol class="arabic simple">
<li>Check that elements are the same in both structures</li>
<li>Convert both structures to primitive form</li>
<li>Check that the total number of atoms in primitive cells are the same</li>
</ol>
<p>4. Check that the number of atoms of each element are the same in
primitive cells</p>
<p>4b. Check that the spacegroup is the same.</p>
<ol class="arabic simple" start="5">
<li>If needed check that the primitive cell volumes are the same</li>
</ol>
<p>6. Convert both primitive cells to reduced form There is one issue here - 
the reduce cell could be type I (all angles acute) or type II (all angles 
obtuse) and a slight difference in the initial cells could cause two 
structures to reduce to different types. So at this step, if the angles 
are not correct, the second cell is transformed as 
[[-1, 0, 0], [0, -1, 0], [0, 0, 1]].</p>
<p>7. Check that the cell internal angles are the same in both reduced
cells.</p>
<p>8. Check that the ratios of reduced cell basis lengths are the same. ie
a1/b1 = a2/b2, a1/c1 = a2/c2, and b1/c1 = b2/c2 where a1, b1, c1, are
the lengths of basis vectors in cell 1 and a2, b2, c2 are the lengths
of cell 2.</p>
<p>9. Get the lattice symmetry of the reduced cell 2 (this is a list of
all rotations that leave the lattice itself unchanged). In turn, apply
all rotations to reduced cell 2 and for each search for a vector that
overlaps rotated cell positions with positions in reduced cell 1. If a
rotation + translation overlaps reduced cells, then they are the same.</p>
<p>MODIFICATIONS:
Only need one &#8220;base&#8221; atom from the first structure
Get the distance from the origin for every atom first</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>other: Another <tt class="docutils literal"><span class="pre">Structure</span></tt>.</dd>
<dt>Keyword Arguments:</dt>
<dd><p class="first">tol: Percent deviation in lattice parameters and angles.</p>
<p class="last">Not Implemented Yet:
wildcard: Elements of the specified type can match with any atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.coords">
<tt class="descname">coords</tt><a class="headerlink" href="#qmpy.Structure.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy.ndarray of atom coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#qmpy.Structure.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a complete copy of the structure, with any primary keys
removed, so it is not associated with the original.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="qmpy.Structure.create">
<em class="property">static </em><tt class="descname">create</tt><big>(</big><em>cell</em>, <em>atoms=</em>, <span class="optional">[</span><span class="optional">]</span><em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Structure.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Structure.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>cell: 3x3 lattice vector array</dd>
<dt>Keyword Arguments:</dt>
<dd>atoms: List of <tt class="docutils literal"><span class="pre">Atom</span></tt> creation arguments. Can be a list of 
[element, coord], or a list of [element, coord, kwargs].</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">3.54</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;Cu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span>
<span class="go">             (&#39;Cu&#39;, [0.5, 0.5, 0.5])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Structure</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;Cu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;magmom&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}),</span>
<span class="go">        (&#39;Cu&#39;, [0.5, 0.5, 0.5], {&#39;magmom&#39;:-3})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">Structure</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.create_vacuum">
<tt class="descname">create_vacuum</tt><big>(</big><em>direction</em>, <em>amount</em>, <em>in_place=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.create_vacuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add vacuum along a lattice direction.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>direction: direction to add the vacuum along. (0=x, 1=y, 2=z)
amount: amount of vacuum in Angstroms.</dd>
<dt>Keyword Arguments:</dt>
<dd>in_place: apply change to current structure, or return a new one.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;/io/files/POSCAR_FCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">create_vacuum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.elements">
<tt class="descname">elements</tt><a class="headerlink" href="#qmpy.Structure.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>List of Elements</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.find_lattice_points_by_transform">
<tt class="descname">find_lattice_points_by_transform</tt><big>(</big><em>transform</em>, <em>tol=1e-06</em><big>)</big><a class="headerlink" href="#qmpy.Structure.find_lattice_points_by_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the lattice points contained within the transformation.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.find_lattice_points_within_distance">
<tt class="descname">find_lattice_points_within_distance</tt><big>(</big><em>distance</em>, <em>tol=1e-06</em><big>)</big><a class="headerlink" href="#qmpy.Structure.find_lattice_points_within_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the lattice points contained within radius <cite>distance</cite> from the
origin.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.find_nearest_neighbors">
<tt class="descname">find_nearest_neighbors</tt><big>(</big><em>method='closest'</em>, <em>tol=0.05</em>, <em>limit=5.0</em><big>)</big><a class="headerlink" href="#qmpy.Structure.find_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the nearest neighbors for all Atoms in Structure.</p>
<p>Calls <tt class="xref py py-func docutils literal"><span class="pre">get_nearest_neighbors()</span></tt> and assigns the nearest
neighbor dictionary to <cite>Structure._neighbor_dict</cite>. Each atom is also
given a list, <cite>nearest_neighbors</cite> that contains the nearest neighbor
atoms. For atoms which have the &#8220;same&#8221; atom as a nearest neighbor across
different periodic boundaries, a single atom may appear multiple times
on the list.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><p class="first">limit: How far to look from each atom for nearest neighbors.
Default=5.0.</p>
<p class="last">tol: A tolerance which determines how much further than the closest
atom a second atom can be and still be a part of the nearest
neighbor shell.</p>
</dd>
</dl>
<p>Returns: None</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.forces">
<tt class="descname">forces</tt><a class="headerlink" href="#qmpy.Structure.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy.ndarray of forces on atoms.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.get_distance">
<tt class="descname">get_distance</tt><big>(</big><em>atom1</em>, <em>atom2</em>, <em>limit=None</em>, <em>wrap_self=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.get_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the shortest distance between two atoms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is not as trivial a problem as it sounds. It is easy to
demonstrate that for any non-cubic cell, the normal method of
calculating the distance by wrapping the vector in fractional
coordinates to the range (-0.5, 0.5) fails for cases near (0.5,0.5)
in Type I cells and near (0.5, -0.5) for Type II.</p>
<p class="last">To get the correct distance, the vector must be wrapped into the
Wigner-Seitz cell.</p>
</div>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>atom1, atom2: (<a class="reference internal" href="#qmpy.Atom" title="qmpy.Atom"><tt class="xref py py-mod docutils literal"><span class="pre">Atom</span></tt></a>, <a class="reference internal" href="#qmpy.Site" title="qmpy.Site"><tt class="xref py py-mod docutils literal"><span class="pre">Site</span></tt></a>, int).</dd>
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>limit: </dt>
<dd>If a limit is provided, returns None if the distance is
greater than the limit.</dd>
<dt>wrap_self: </dt>
<dd>If True, the distance from an atom to itself is 0, otherwise it
is the distance to the shortest periodic image of itself.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.get_sites">
<tt class="descname">get_sites</tt><big>(</big><em>tol=0.1</em><big>)</big><a class="headerlink" href="#qmpy.Structure.get_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>From self.atoms, creates a list of Sites. Atoms which are closer
than tol from one another are considered on the same site.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.get_spin_lattice">
<tt class="descname">get_spin_lattice</tt><big>(</big><em>elements=None</em>, <em>supercell=None</em><big>)</big><a class="headerlink" href="#qmpy.Structure.get_spin_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a lattice of sites.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>elements:</dt>
<dd>If <cite>elements</cite> is supplied, get_spin_lattice will return the 
lattice of those elements only.</dd>
<dt>supercell:</dt>
<dd>Accepts any valid input to Structure.transform to construct a
supercell, and return its lattice. Useful for finding AFM
orderings for structures which have a smaller periodicity than
their magnetic structure.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A SpinLattice, which is a container for a lattice graph, which
contains nodes which are atoms and edges which indicate nearest
neighbors.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;/io/files/fe3o4.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_spin_lattice</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Fe&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span><span class="o">.</span><span class="n">set_fraction</span><span class="p">(</span><span class="mf">0.33333</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span><span class="o">.</span><span class="n">fraction</span>
<span class="go">0.3333333333333333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span><span class="o">.</span><span class="n">run_MC</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.get_volume">
<tt class="descname">get_volume</tt><big>(</big><big>)</big><a class="headerlink" href="#qmpy.Structure.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the volume from the triple product of self.cell</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.group_atoms_by_symmetry">
<tt class="descname">group_atoms_by_symmetry</tt><big>(</big><big>)</big><a class="headerlink" href="#qmpy.Structure.group_atoms_by_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort self.atoms according to the site they occupy.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.inv">
<tt class="descname">inv</tt><a class="headerlink" href="#qmpy.Structure.inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Precalculates the inverse of the lattice, for faster conversion
between cartesian and direct coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.is_buerger_cell">
<tt class="descname">is_buerger_cell</tt><big>(</big><em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.is_buerger_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether or not the structure is a Buerger cell.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.is_niggli_cell">
<tt class="descname">is_niggli_cell</tt><big>(</big><em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.is_niggli_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether or not the structure is a Niggli cell.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.joggle_atoms">
<tt class="descname">joggle_atoms</tt><big>(</big><em>distance=0.001</em>, <em>in_place=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.joggle_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly displace all atoms in each direction by a distance up to +/- the
distance keyword argument (in Angstroms).</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><dl class="first last docutils">
<dt><em>distance</em> <span class="classifier-delimiter">:</span> <span class="classifier">Range within all internal coordinates are</span></dt>
<dd>displaced. Default=1e-3</dd>
<dt><em>in_place</em> <span class="classifier-delimiter">:</span> <span class="classifier">If True, returns an ndarray of the applied</span></dt>
<dd>translations. If False, returns (Structure,
translations).</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="p">,</span> <span class="n">trans</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">joggle_atoms</span><span class="p">(</span><span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">joggle_atoms</span><span class="p">(</span><span class="mf">1e-1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">joggle_atoms</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.keyword_objects">
<tt class="descname">keyword_objects</tt><a class="headerlink" href="#qmpy.Structure.keyword_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of keywords (MetaData objects of type keyword)</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.lat_param_dict">
<tt class="descname">lat_param_dict</tt><a class="headerlink" href="#qmpy.Structure.lat_param_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of lattice parameters.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.lat_param_string">
<tt class="descname">lat_param_string</tt><big>(</big><em>format='screen'</em><big>)</big><a class="headerlink" href="#qmpy.Structure.lat_param_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a human friendly representation of the lattice parameters of
a structure.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd>format: (&#8216;screen&#8217;|&#8217;html&#8217;|&#8217;mathtype&#8217;)</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.lat_params">
<tt class="descname">lat_params</tt><a class="headerlink" href="#qmpy.Structure.lat_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of lattice parameters (a, b, c, alpha, beta, gamma).</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.lp">
<tt class="descname">lp</tt><a class="headerlink" href="#qmpy.Structure.lp" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of lattice parameters (a, b, c, alpha, beta, gamma).</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.magmoms">
<tt class="descname">magmoms</tt><a class="headerlink" href="#qmpy.Structure.magmoms" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy.ndarray of magnetic moments of shape (natoms,).</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.make_conventional">
<tt class="descname">make_conventional</tt><big>(</big><em>in_place=True</em>, <em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.make_conventional" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses spglib to convert to the conventional cell.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>in_place: </dt>
<dd>If True, changes the current structure. If false returns
a new one</dd>
<dt>tol: </dt>
<dd>Symmetry precision for symmetry analysis</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;io/files/POSCAR_FCC_prim&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">make_conventional</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.make_perfect">
<tt class="descname">make_perfect</tt><big>(</big><em>in_place=True</em>, <em>tol=0.1</em><big>)</big><a class="headerlink" href="#qmpy.Structure.make_perfect" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs options for a &#8216;perfect&#8217; lattice from the structure.</p>
<p>If a site is not fully occupied, but has only one atom type on it, it
will be filled the rest of the way.
If a site has two or more atom types on it, the higher fraction element
will fill the site.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><p class="first">in_place: If False returns a new <a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a>, otherwise
returns None</p>
<p class="last">tol: maximum defect concentration.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;/io/files/partial_vac.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Structure: Mn3.356Si4O16&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">make_perfect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Structure: MnSiO4&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;/io/files/partial_mix.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Structure: Mn4.264Co3.736Si4O16&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">make_perfect</span><span class="p">(</span><span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Structure: MnCoSiO4&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.make_primitive">
<tt class="descname">make_primitive</tt><big>(</big><em>in_place=True</em>, <em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.make_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses spglib to convert to the primitive cell.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>in_place: </dt>
<dd>If True, changes the current structure. If false returns
a new one</dd>
<dt>tol: </dt>
<dd>Symmetry precision for symmetry analysis</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">INSTALL_PATH</span><span class="o">+</span><span class="s">&#39;io/files/POSCAR_FCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">make_primitive</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.metrical_matrix">
<tt class="descname">metrical_matrix</tt><a class="headerlink" href="#qmpy.Structure.metrical_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>np.dot(self.cell.T, self.cell)</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.name">
<tt class="descname">name</tt><a class="headerlink" href="#qmpy.Structure.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Unformatted name.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.nearest_neighbor_dict">
<tt class="descname">nearest_neighbor_dict</tt><a class="headerlink" href="#qmpy.Structure.nearest_neighbor_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of Atom:[list of Atom] pairs.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.pdf_compare">
<tt class="descname">pdf_compare</tt><big>(</big><em>other</em>, <em>tol=0.01</em><big>)</big><a class="headerlink" href="#qmpy.Structure.pdf_compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the PDF for each structure and evaluate the overlap integral
for all pairs of species.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.recenter">
<tt class="descname">recenter</tt><big>(</big><em>atom</em>, <em>in_place=True</em>, <em>middle=False</em><big>)</big><a class="headerlink" href="#qmpy.Structure.recenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the internal coordinates to center the specified atom. Atom
can be an actual Atom from the Structure.atoms list, or can be
identified by index.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>in_place: </dt>
<dd>If False, return a new Structure with the transformation applied.
defaults to True.</dd>
<dt>middle:</dt>
<dd>If False, &#8220;centers&#8221; the cell by putting the atom at the origin.
If True, &#8220;centers&#8221; the cell by putting the atom at
(0.5,0.5,0.5). defaults to False.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">recenter</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recenter</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">recenter</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">==</span> <span class="n">s2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.reciprocal_lattice">
<tt class="descname">reciprocal_lattice</tt><a class="headerlink" href="#qmpy.Structure.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice of the structure.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.reduce">
<tt class="descname">reduce</tt><big>(</big><em>tol=0.001</em>, <em>limit=1000</em>, <em>in_place=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transformation matrix from unit to reduced cell
Acta. Cryst. (1976) A32, 297
Acta. Cryst. (2003) A60, 1</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><dl class="first last docutils">
<dt><em>tol</em> <span class="classifier-delimiter">:</span> <span class="classifier"></span></dt>
<dd>eps_rel in Acta. Cryst. 2003 above. Similar to 
tolerance for floating point comparisons. Defaults to 1e-5.</dd>
<dt><em>limit</em> <span class="classifier-delimiter">:</span> <span class="classifier"></span></dt>
<dd>maximum number of loops through the algorithm. Defaults to 
1000.</dd>
<dt><em>in_place</em> <span class="classifier-delimiter">:</span> <span class="classifier"></span></dt>
<dd>Change the Structure or return a new one. If True, the 
transformation matrix is returned. If False, a tuple of
(Structure, transformation_matrix) is returned.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">get_transform</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.refine">
<tt class="descname">refine</tt><big>(</big><em>tol=0.001</em>, <em>recurse=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.refine" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify atoms that are close to high symmetry sites (within <cite>tol</cite> and
shift them onto them.</p>
<dl class="docutils">
<dt>Note: </dt>
<dd>&#8220;symprec&#8221; doesn&#8217;t appear to do anything with spglib, so I am
unable to get &#8220;loose&#8221; symmetry operations. Without which, this 
doesn&#8217;t work.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">spacegroup</span>
<span class="go">225L</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">refine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">spacegroup</span>
<span class="go">1L</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.set_magnetism">
<tt class="descname">set_magnetism</tt><big>(</big><em>type</em>, <em>scheme='primitive'</em><big>)</big><a class="headerlink" href="#qmpy.Structure.set_magnetism" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns magnetic moments to all atoms in accordance with the specified
magnetism scheme.</p>
<p>Schemes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>None</td>
<td>all magnetic moments = None</td>
</tr>
<tr class="row-odd"><td>&#8220;ferro&#8221;</td>
<td>atoms with partially filled d and
f shells are assigned a magnetic
moment of 5 mu_b</td>
</tr>
<tr class="row-even"><td>&#8220;anti&#8221;</td>
<td>finds a highly ordererd arrangement
arrangement of up and down spins.
If only 1 magnetic atom is found
a ferromagnetic arrangment is used.
raises NotImplementedError</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.set_natoms">
<tt class="descname">set_natoms</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#qmpy.Structure.set_natoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.atoms to n blank Atoms.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.set_nsites">
<tt class="descname">set_nsites</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#qmpy.Structure.set_nsites" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets self.sites to n blank Sites.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.set_volume">
<tt class="descname">set_volume</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#qmpy.Structure.set_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales the unit cell to the specified volume, keeping the direction
and relative magnitudes of all lattice vectors the same.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.site_coords">
<tt class="descname">site_coords</tt><a class="headerlink" href="#qmpy.Structure.site_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy.ndarray of site coordinates.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.sites">
<tt class="descname">sites</tt><a class="headerlink" href="#qmpy.Structure.sites" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <tt class="docutils literal"><span class="pre">Sites</span></tt> in the structure.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.spec_comp">
<tt class="descname">spec_comp</tt><a class="headerlink" href="#qmpy.Structure.spec_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Species composition dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.species">
<tt class="descname">species</tt><a class="headerlink" href="#qmpy.Structure.species" title="Permalink to this definition">¶</a></dt>
<dd><p>List of species</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.species_types">
<tt class="descname">species_types</tt><a class="headerlink" href="#qmpy.Structure.species_types" title="Permalink to this definition">¶</a></dt>
<dd><p>List of species, length equal to number of atoms.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.stresses">
<tt class="descname">stresses</tt><a class="headerlink" href="#qmpy.Structure.stresses" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated stresses, a numpy.ndarray of shape (6,)</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.sub">
<tt class="descname">sub</tt><big>(</big><em>replace</em>, <em>rescale=True</em>, <em>in_place=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Structure.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace atoms, as specified in a dict of pairs.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>rescale: </dt>
<dd>rescale the volume of the final structure based on the per 
atom volume of the new composition.</dd>
<dt>in_place: </dt>
<dd>change the species of the current Structure or return a new 
one.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR-Fe2O3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">substitute</span><span class="p">({</span><span class="s">&#39;Fe&#39;</span><span class="p">:</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">:</span><span class="s">&#39;F&#39;</span><span class="p">}</span> <span class="n">rescale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">substitute</span><span class="p">({</span><span class="s">&#39;Ni&#39;</span><span class="p">:</span><span class="s">&#39;Co&#39;</span><span class="p">},</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.substitute">
<tt class="descname">substitute</tt><big>(</big><em>replace</em>, <em>rescale=True</em>, <em>in_place=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Structure.substitute" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace atoms, as specified in a dict of pairs.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>rescale: </dt>
<dd>rescale the volume of the final structure based on the per 
atom volume of the new composition.</dd>
<dt>in_place: </dt>
<dd>change the species of the current Structure or return a new 
one.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR-Fe2O3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">substitute</span><span class="p">({</span><span class="s">&#39;Fe&#39;</span><span class="p">:</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">:</span><span class="s">&#39;F&#39;</span><span class="p">}</span> <span class="n">rescale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">substitute</span><span class="p">({</span><span class="s">&#39;Ni&#39;</span><span class="p">:</span><span class="s">&#39;Co&#39;</span><span class="p">},</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.symmetrize">
<tt class="descname">symmetrize</tt><big>(</big><em>tol=0.001</em>, <em>angle_tol=-1</em><big>)</big><a class="headerlink" href="#qmpy.Structure.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze the symmetry of the structure. Uses spglib to find the
symmetry.</p>
<dl class="docutils">
<dt>symmetrize sets:</dt>
<dd><ul class="first last simple">
<li>spacegroup -&gt; Spacegroup</li>
<li>uniq_sites -&gt; list of unique Sites</li>
<li>orbits -&gt; lists of equivalent Atoms</li>
<li>rotations -&gt; List of rotation operations</li>
<li>translations -&gt; List of translation operations</li>
<li>operatiosn -&gt; List of (rotation,translation) pairs</li>
<li>for each atom: atom.wyckoff -&gt; WyckoffSite</li>
<li>for each site: site.multiplicity -&gt; int</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.t">
<tt class="descname">t</tt><big>(</big><em>transform</em>, <em>in_place=True</em>, <em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.t" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply lattice transform to the structure. Accepts transformations of
shape (3,) and (3,3).</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><dl class="first last docutils">
<dt><em>in_place</em> <span class="classifier-delimiter">:</span> <span class="classifier">If False, return a new Structure with the</span></dt>
<dd>transformation applied.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c"># 2x2x2 supercell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> <span class="c"># swap axis 1 for 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.transform">
<tt class="descname">transform</tt><big>(</big><em>transform</em>, <em>in_place=True</em>, <em>tol=1e-05</em><big>)</big><a class="headerlink" href="#qmpy.Structure.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply lattice transform to the structure. Accepts transformations of
shape (3,) and (3,3).</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><dl class="first last docutils">
<dt><em>in_place</em> <span class="classifier-delimiter">:</span> <span class="classifier">If False, return a new Structure with the</span></dt>
<dd>transformation applied.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c"># 2x2x2 supercell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> <span class="c"># swap axis 1 for 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="qmpy.Structure.translate">
<tt class="descname">translate</tt><big>(</big><em>cv</em>, <em>cartesian=True</em>, <em>in_place=True</em><big>)</big><a class="headerlink" href="#qmpy.Structure.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the contents of the structure by a vector.</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><dl class="first last docutils">
<dt><em>cartesian</em> <span class="classifier-delimiter">:</span> <span class="classifier">If True, translation vector is taken to be</span></dt>
<dd>cartesian coordinates. If False, translation
vector is taken to be in fractional
coordinates. Default=True</dd>
<dt><em>in_place</em> <span class="classifier-delimiter">:</span> <span class="classifier">If False, return a new Structure with the</span></dt>
<dd>transformation applied.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;POSCAR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">cartesian</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">translate</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Structure.unit_comp">
<tt class="descname">unit_comp</tt><a class="headerlink" href="#qmpy.Structure.unit_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Composition dict, where sum(self.unit_comp.values()) == 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="qmpy.Prototype">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Prototype</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for a prototype structure.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="#qmpy.Composition" title="qmpy.Composition"><tt class="xref py py-mod docutils literal"><span class="pre">Composition</span></tt></a> via composition_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure_set</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Entry</span></tt> via entry_set</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line">name: Prototype name.</div>
</div>
</dd>
</dl>
<dl class="classmethod">
<dt id="qmpy.Prototype.get">
<em class="property">classmethod </em><tt class="descname">get</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#qmpy.Prototype.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a <a class="reference internal" href="#qmpy.Prototype" title="qmpy.Prototype"><tt class="xref py py-mod docutils literal"><span class="pre">Prototype</span></tt></a> named <cite>name</cite> if it exists. If not, creates
a new one.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">proto</span> <span class="o">=</span> <span class="n">Prototype</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Corundum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="atom">
<h2>Atom<a class="headerlink" href="#atom" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="qmpy.Atom">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Atom</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Model for an Atom.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure</div>
<div class="line"><a class="reference internal" href="#qmpy.Element" title="qmpy.Element"><tt class="xref py py-mod docutils literal"><span class="pre">Element</span></tt></a> via element</div>
<div class="line"><a class="reference internal" href="#qmpy.Site" title="qmpy.Site"><tt class="xref py py-mod docutils literal"><span class="pre">Site</span></tt></a> via site </div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.WyckoffSite" title="qmpy.WyckoffSite"><tt class="xref py py-mod docutils literal"><span class="pre">WyckoffSite</span></tt></a> via wyckoff</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line">id</div>
<div class="line">x, y, z: Coordinate of the atom</div>
<div class="line">fx, fy, fz: Forces on the atom</div>
<div class="line">magmom: Magnetic moment on the atom (in &amp;Mu;&lt;sub&gt;b&lt;/sub&gt;)</div>
<div class="line">occupancy: Occupation fraction (0-1).</div>
<div class="line">ox: Oxidation state of the atom (can be different from charge)</div>
<div class="line">charge: Charge on the atom</div>
<div class="line">volume: Volume occupied by the atom</div>
</div>
</dd>
</dl>
<dl class="attribute">
<dt id="qmpy.Atom.cart_coord">
<tt class="descname">cart_coord</tt><a class="headerlink" href="#qmpy.Atom.cart_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of the Atom.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Atom.coord">
<tt class="descname">coord</tt><a class="headerlink" href="#qmpy.Atom.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>[x,y,z] coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Atom.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#qmpy.Atom.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an exact copy of the atom, only without the matching primary
key.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">id</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;Atom: Fe - 0.000, 0.000, 0.000&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">id</span>
<span class="go">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="qmpy.Atom.create">
<em class="property">classmethod </em><tt class="descname">create</tt><big>(</big><em>element</em>, <em>coord</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Atom.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Atom object.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>element (str or Element): Specifies the element of the Atom.
coord (iterable of floats): Specifies the coordinate of the Atom.</dd>
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>forces: </dt>
<dd>Specifies the forces on the atom.</dd>
<dt>magmom: </dt>
<dd>The magnitude of the magnetic moment on the atom.</dd>
<dt>charge: </dt>
<dd>The charge on the Atom.</dd>
<dt>volume: </dt>
<dd>The atomic volume of the atom (Angstroms^3).</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">ox</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">magmom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">forces</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">volume</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">occupancy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Atom.forces">
<tt class="descname">forces</tt><a class="headerlink" href="#qmpy.Atom.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces on the Atom in [x, y, z] directions.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Atom.index">
<tt class="descname">index</tt><a class="headerlink" href="#qmpy.Atom.index" title="Permalink to this definition">¶</a></dt>
<dd><p>None if not in a <a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a>, otherwise the index of the atom 
in the structure.</p>
</dd></dl>

<dl class="method">
<dt id="qmpy.Atom.is_on">
<tt class="descname">is_on</tt><big>(</big><em>site</em>, <em>tol=0.001</em><big>)</big><a class="headerlink" href="#qmpy.Atom.is_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether or not the <tt class="docutils literal"><span class="pre">Atom</span></tt> is on the specified <tt class="docutils literal"><span class="pre">Site</span></tt>.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_site</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span><span class="o">.</span><span class="n">is_on</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Atom.species">
<tt class="descname">species</tt><a class="headerlink" href="#qmpy.Atom.species" title="Permalink to this definition">¶</a></dt>
<dd><p>Formatted Species string. e.g. Fe3+, O2-</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="site">
<h2>Site<a class="headerlink" href="#site" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="qmpy.Site">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Site</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Site" title="Permalink to this definition">¶</a></dt>
<dd><p>A lattice site.</p>
<p>A site can be occupied by one Atom, many Atoms or no Atoms.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure</div>
<div class="line"><a class="reference internal" href="#qmpy.Atom" title="qmpy.Atom"><tt class="xref py py-mod docutils literal"><span class="pre">Atom</span></tt></a> via atom_set</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.WyckoffSite" title="qmpy.WyckoffSite"><tt class="xref py py-mod docutils literal"><span class="pre">WyckoffSite</span></tt></a> via wyckoff</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line">id</div>
<div class="line">x, y, z: Coordinate of the Site</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="qmpy.Site.add_atom">
<tt class="descname">add_atom</tt><big>(</big><em>atom</em>, <em>tol=0.01</em><big>)</big><a class="headerlink" href="#qmpy.Site.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds Atom to <cite>Site.atoms</cite>.</p>
<dl class="docutils">
<dt>Notes:</dt>
<dd>If the Site being assigned to doens&#8217;t have a coordinate, it is assigned
the coordinate of <cite>atom</cite>.</dd>
<dt>Arguments:</dt>
<dd>atom (Atom): Atom to add to the structure.</dd>
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>tol (float): Distance between <cite>atom</cite> and the Site for the Atom to be </dt>
<dd>assigned to the Site. Raises a SiteError if the distance is 
greater than <cite>tol</cite>.</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd>SiteError: If <cite>atom</cite> is more than <cite>tol</cite> from the Site.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">create</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">Site</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.atoms">
<tt class="descname">atoms</tt><a class="headerlink" href="#qmpy.Site.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of Atoms on the Site.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.cart_coord">
<tt class="descname">cart_coord</tt><a class="headerlink" href="#qmpy.Site.cart_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of the Atom.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.comp">
<tt class="descname">comp</tt><a class="headerlink" href="#qmpy.Site.comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Composition dictionary of the Site.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>dict: of (element, occupancy) pairs.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">comp</span>
<span class="go">{&#39;Fe&#39;:0.2, &#39;Ni&#39;:0.8}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.coord">
<tt class="descname">coord</tt><a class="headerlink" href="#qmpy.Site.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>[Site.x, Site.y, Site.z]</p>
</dd></dl>

<dl class="staticmethod">
<dt id="qmpy.Site.create">
<em class="property">static </em><tt class="descname">create</tt><big>(</big><em>coord</em>, <em>comp=None</em><big>)</big><a class="headerlink" href="#qmpy.Site.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a Site from a coordinate.</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>The Site is created without any Atoms occupying it.</dd>
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>coord (length 3 iterable): Assigns the x, y, and z coordinates of </dt>
<dd>the Site.</dd>
</dl>
</dd>
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>comp (dict, string, or qmpy.Element): Composition dictionary.</dt>
<dd>Flexible about input forms. Options include: &lt;Element: Fe&gt;, &#8216;Fe&#8217;,
{&#8220;Fe&#8221;:0.5, &#8220;Co&#8221;:0.5}, and {&lt;Element: Ni&gt;:0.5, &lt;Element: Co&gt;:0.5}.</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd>TypeError: if <cite>comp</cite> isn&#8217;t a string, <tt class="docutils literal"><span class="pre">Atom</span></tt>, <tt class="docutils literal"><span class="pre">Element</span></tt>.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">create</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="qmpy.Site.from_atoms">
<em class="property">classmethod </em><tt class="descname">from_atoms</tt><big>(</big><em>atoms</em>, <em>tol=0.0001</em><big>)</big><a class="headerlink" href="#qmpy.Site.from_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a Site from an iterable of Atoms.</p>
<dl class="docutils">
<dt>Notes:</dt>
<dd><p class="first">Site.coord is set as the average coord of all assigned Atoms.</p>
<p class="last">Checks that the Atoms are close together. If the Atoms are further
apart than <cite>tol</cite>, raises a SiteError</p>
</dd>
<dt>Arguments:</dt>
<dd>atoms (iterable of <cite>Atom</cite>): List of Atoms to occupy the Site.</dd>
<dt>Keyword Arguments:</dt>
<dd>tol (float): Atoms must be within <cite>tol</cite> of each other to be assigned 
to the same Site. Defaults to 1e-4.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.label">
<tt class="descname">label</tt><a class="headerlink" href="#qmpy.Site.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a human friendly label for the Site, based on its atomic
composition. If singly occupied, returns the symbol of the atom on the
site. If multiply occupied, returns a comma seperated string</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.magmom">
<tt class="descname">magmom</tt><a class="headerlink" href="#qmpy.Site.magmom" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the composition weighted average magnetic moment of the atoms 
on the Site.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>float or None</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.occupancy">
<tt class="descname">occupancy</tt><a class="headerlink" href="#qmpy.Site.occupancy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total occupancy of the site.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>float or None</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.ox">
<tt class="descname">ox</tt><a class="headerlink" href="#qmpy.Site.ox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the composition weighted average oxidation state of the atoms 
on the Site.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>float or None</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Site.spec_comp">
<tt class="descname">spec_comp</tt><a class="headerlink" href="#qmpy.Site.spec_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Composition dictionary of the Site.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>dict: of (species, occupancy) pairs.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">comp</span>
<span class="go">{&#39;Fe&#39;:0.2, &#39;Ni&#39;:0.8}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="element">
<h2>Element<a class="headerlink" href="#element" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="qmpy.Element">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Element</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Core model for an element.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="#qmpy.Atom" title="qmpy.Atom"><tt class="xref py py-mod docutils literal"><span class="pre">Atom</span></tt></a> via atom_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Species" title="qmpy.Species"><tt class="xref py py-mod docutils literal"><span class="pre">Species</span></tt></a> via species_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure_set</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Entry</span></tt> via entry_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Composition" title="qmpy.Composition"><tt class="xref py py-mod docutils literal"><span class="pre">Composition</span></tt></a> via composition_set</div>
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Calculation" title="qmpy.Calculation"><tt class="xref py py-mod docutils literal"><span class="pre">Calculation</span></tt></a> via calculation_set</div>
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Potential" title="qmpy.Potential"><tt class="xref py py-mod docutils literal"><span class="pre">Potential</span></tt></a> via potential_set</div>
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Hubbard" title="qmpy.Hubbard"><tt class="xref py py-mod docutils literal"><span class="pre">Hubbard</span></tt></a> via hubbards</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.HubbardCorrection" title="qmpy.HubbardCorrection"><tt class="xref py py-mod docutils literal"><span class="pre">HubbardCorrection</span></tt></a> via hubbardcorrection_set</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.ReferenceEnergy" title="qmpy.ReferenceEnergy"><tt class="xref py py-mod docutils literal"><span class="pre">ReferenceEnergy</span></tt></a> via referenceenergy_set</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line"><strong>Identification</strong></div>
<div class="line">z: atomic number</div>
<div class="line">name: full atomic name</div>
<div class="line">symbol: atomic symbol</div>
<div class="line">group: group in the periodic table</div>
<div class="line">period: period in the periodic table</div>
<div class="line"><br /></div>
<div class="line"><strong>Physical properties</strong></div>
<div class="line">mass: Atomic mass, in AMU (float)</div>
<div class="line">density: Density at STP, in g/cm^3 (float)</div>
<div class="line">volume: Atomic volume at STP, in A^3/atom (float)</div>
<div class="line">atomic_radii: in A (float)</div>
<div class="line">van_der_waals radii: in A (float)</div>
<div class="line">covalent_radii: in A (float)</div>
<div class="line">scattering_factors: A dictionary of scattering factor coeffs.</div>
<div class="line"><br /></div>
<div class="line"><strong>Thermodynamic properties</strong></div>
<div class="line">melt: melting point in K</div>
<div class="line">boil: boiling point in K</div>
<div class="line">specific_heat: C_p in J/K</div>
<div class="line"><br /></div>
<div class="line"><strong>Electronic properties</strong></div>
<div class="line">electronegativity: Pauling electronegativity</div>
<div class="line">ion_energy: First ionization energy. (eV)</div>
<div class="line">s_elec: # of s electrons</div>
<div class="line">p_elec: # of p electrons</div>
<div class="line">d_elec: # of d electrons</div>
<div class="line">f_elec: # of f electrons</div>
<div class="line"><br /></div>
<div class="line"><strong>Additional information</strong></div>
<div class="line">production: Annual tons of element produced.</div>
<div class="line">abundance: Amount in earths crust (ppm)</div>
<div class="line">radioactive: Are all isotopes unstable?</div>
<div class="line">HHI_P: Herfindahl-Hirschman Index for production.</div>
<div class="line">HHI_R: Herfindahl-Hirschman Index for reserve</div>
</div>
</dd>
<dt>Note:</dt>
<dd>HHI values from Gaultois, M. et al. Chem. Mater. 25, 2911-2920 (2013).</dd>
</dl>
<dl class="classmethod">
<dt id="qmpy.Element.get">
<em class="property">classmethod </em><tt class="descname">get</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#qmpy.Element.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element object. Accepts symbols and atomic numbers, or a list
of symbols/atomic numbers.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Element</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="qmpy.Species">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Species</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Species" title="Permalink to this definition">¶</a></dt>
<dd><p>Base model for an atomic species. (Element + charge state).</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="#qmpy.Element" title="qmpy.Element"><tt class="xref py py-mod docutils literal"><span class="pre">Element</span></tt></a> via element</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Entry</span></tt> via entry_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure_set</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line">name: Species name. e.g. Fe3+, O2-</div>
<div class="line">ox: Oxidation state (float)</div>
</div>
</dd>
</dl>
<dl class="classmethod">
<dt id="qmpy.Species.get">
<em class="property">classmethod </em><tt class="descname">get</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#qmpy.Species.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets or creates the specified species.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>value: </dt>
<dd>Accepts multiple input types. Can be a string, e.g. Fe3+
or a tuple of (symbol, oxidation state) pairs, e.g. (Fe, 3).</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd>A <a class="reference internal" href="#qmpy.Species" title="qmpy.Species"><tt class="xref py py-mod docutils literal"><span class="pre">Species</span></tt></a> or list of <a class="reference internal" href="#qmpy.Species" title="qmpy.Species"><tt class="xref py py-mod docutils literal"><span class="pre">Species</span></tt></a>.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Species</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Fe3+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Species</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Fe3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Species</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Species</span><span class="o">.</span><span class="n">get</span><span class="p">([</span> <span class="s">&#39;Fe3+&#39;</span><span class="p">,</span> <span class="s">&#39;O2-&#39;</span><span class="p">,</span> <span class="s">&#39;Li1+&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="composition">
<h2>Composition<a class="headerlink" href="#composition" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="qmpy.Composition">
<em class="property">class </em><tt class="descclassname">qmpy.</tt><tt class="descname">Composition</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#qmpy.Composition" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for a composition.</p>
<dl class="docutils">
<dt>Relationships:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="calculations.html#qmpy.Calculation" title="qmpy.Calculation"><tt class="xref py py-mod docutils literal"><span class="pre">Calculation</span></tt></a> via calculation_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Element" title="qmpy.Element"><tt class="xref py py-mod docutils literal"><span class="pre">Element</span></tt></a> via element_set</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">Entry</span></tt> via entry_set</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.ExptFormationEnergy" title="qmpy.ExptFormationEnergy"><tt class="xref py py-mod docutils literal"><span class="pre">ExptFormationEnergy</span></tt></a> via exptformationenergy_set</div>
<div class="line"><a class="reference internal" href="analysis.html#qmpy.FormationEnergy" title="qmpy.FormationEnergy"><tt class="xref py py-mod docutils literal"><span class="pre">FormationEnergy</span></tt></a> via formationenergy_set</div>
<div class="line"><tt class="xref py py-mod docutils literal"><span class="pre">MetaData</span></tt> via meta_data</div>
<div class="line"><a class="reference internal" href="#qmpy.Structure" title="qmpy.Structure"><tt class="xref py py-mod docutils literal"><span class="pre">Structure</span></tt></a> via structure_set</div>
<div class="line"><a class="reference internal" href="#qmpy.Prototype" title="qmpy.Prototype"><tt class="xref py py-mod docutils literal"><span class="pre">Prototype</span></tt></a> via prototype_set</div>
</div>
</dd>
<dt>Attributes:</dt>
<dd><div class="first last line-block">
<div class="line">formula: Electronegativity sorted and normalized composition string.</div>
<div class="line-block">
<div class="line">e.g. Fe2O3, LiFeO2</div>
</div>
<div class="line">generic: Genericized composition string. e.g. A2B3, ABC2.</div>
<div class="line">mass: Mass per atom in AMUs</div>
<div class="line">meidema: Meidema model energy for the composition</div>
<div class="line">ntypes: Number of elements. </div>
</div>
</dd>
</dl>
<dl class="attribute">
<dt id="qmpy.Composition.comp">
<tt class="descname">comp</tt><a class="headerlink" href="#qmpy.Composition.comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element:amount composition dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.delta_e">
<tt class="descname">delta_e</tt><a class="headerlink" href="#qmpy.Composition.delta_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lowest formation energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.experiment">
<tt class="descname">experiment</tt><a class="headerlink" href="#qmpy.Composition.experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lowest experimantally measured formation energy at the
compositoin.</p>
</dd></dl>

<dl class="classmethod">
<dt id="qmpy.Composition.get">
<em class="property">classmethod </em><tt class="descname">get</tt><big>(</big><em>composition</em><big>)</big><a class="headerlink" href="#qmpy.Composition.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod for getting Composition objects - if the Composition
existsin the database, it is returned. If not, a new Composition is
created.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Composition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Fe2O3&#39;</span><span class="p">)</span>
<span class="go">&lt;Composition: Fe2O3&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="qmpy.Composition.get_list">
<em class="property">classmethod </em><tt class="descname">get_list</tt><big>(</big><em>bounds</em>, <em>calculated=False</em>, <em>uncalculated=False</em><big>)</big><a class="headerlink" href="#qmpy.Composition.get_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod for finding all compositions within the space bounded by a
sequence of compositions.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comps</span> <span class="o">=</span> <span class="n">Composition</span><span class="o">.</span><span class="n">get_list</span><span class="p">([</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">],</span> <span class="n">calculated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">comps</span><span class="p">))</span>
<span class="go">[&lt;Composition: Fe&gt;,</span>
<span class="go"> &lt;Composition: FeO&gt;,</span>
<span class="go"> &lt;Composition: FeO3&gt;,</span>
<span class="go"> &lt;Composition: Fe2O3&gt;,</span>
<span class="go"> &lt;Composition: Fe3O4&gt;,</span>
<span class="go"> &lt;Composition: Fe4O5&gt;,</span>
<span class="go"> &lt;Composition: O&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.ground_state">
<tt class="descname">ground_state</tt><a class="headerlink" href="#qmpy.Composition.ground_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the most stable entry at the composition.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.icsd_delta_e">
<tt class="descname">icsd_delta_e</tt><a class="headerlink" href="#qmpy.Composition.icsd_delta_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lowest formation energy calculated from experimentally
measured structures - i.e. excluding prototypes.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.ndistinct">
<tt class="descname">ndistinct</tt><a class="headerlink" href="#qmpy.Composition.ndistinct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of distinct entries.</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.space">
<tt class="descname">space</tt><a class="headerlink" href="#qmpy.Composition.space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of element symbols</p>
</dd></dl>

<dl class="attribute">
<dt id="qmpy.Composition.unit_comp">
<tt class="descname">unit_comp</tt><a class="headerlink" href="#qmpy.Composition.unit_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element:amoutn composition dictionary normalized to a unit
composition.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Materials</a><ul>
<li><a class="reference internal" href="#structure">Structure</a></li>
<li><a class="reference internal" href="#atom">Atom</a></li>
<li><a class="reference internal" href="#site">Site</a></li>
<li><a class="reference internal" href="#element">Element</a></li>
<li><a class="reference internal" href="#composition">Composition</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="models.html"
                        title="previous chapter">Data models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="calculations.html"
                        title="next chapter">Calculations</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/materials.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="calculations.html" title="Calculations"
             >next</a> |</li>
        <li class="right" >
          <a href="models.html" title="Data models"
             >previous</a> |</li>
        <li><a href="index.html">qmpy 0.4.9 documentation</a> &raquo;</li>
          <li><a href="models.html" >Data models</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Scott Kirklin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>